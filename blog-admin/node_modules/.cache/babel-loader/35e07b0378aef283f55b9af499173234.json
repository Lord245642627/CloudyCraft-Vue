{"ast":null,"code":"export default {\n  data: function () {\n    return {\n      infoForm: {\n        nickname: this.$store.state.userInfo.nickname,\n        intro: this.$store.state.userInfo.intro,\n        website: this.$store.state.userInfo.website\n      },\n      passwordForm: {\n        oldPassword: '',\n        newPassword: '',\n        confirmPassword: ''\n      },\n      activeName: 'info',\n      headers: {\n        Authorization: 'Bearer ' + sessionStorage.getItem('token')\n      }\n    };\n  },\n  methods: {\n    handleClick(tab) {\n      if (tab.index == 2 && this.notice == '') {\n        this.axios.get('/api/admin/notice').then(({\n          data\n        }) => {\n          this.notice = data.data;\n        });\n      }\n    },\n\n    updateAvatar(response) {\n      if (response.code === 0) {\n        this.$message.success(response.message);\n        this.$store.commit('updateAvatar', response.data);\n      } else {\n        this.$message.error(response.message);\n      }\n    },\n\n    updateInfo() {\n      if (this.infoForm.nickname.trim() == '') {\n        this.$message.error('昵称不能为空');\n        return false;\n      }\n\n      this.axios.put('/api/users/info', this.infoForm).then(({\n        data\n      }) => {\n        if (data.code === 0) {\n          this.$notify.success({\n            title: '成功',\n            message: '修改成功'\n          });\n          this.$store.commit('updateUserInfo', this.infoForm);\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: '修改失败'\n          });\n        }\n      });\n    },\n\n    updatePassword() {\n      if (this.passwordForm.oldPassword.trim() == '') {\n        this.$message.error('旧密码不能为空');\n        return false;\n      }\n\n      if (this.passwordForm.newPassword.trim() == '') {\n        this.$message.error('新密码不能为空');\n        return false;\n      }\n\n      if (this.passwordForm.newPassword.length < 6) {\n        this.$message.error('新密码不能少于6位');\n        return false;\n      }\n\n      if (this.passwordForm.newPassword != this.passwordForm.confirmPassword) {\n        this.$message.error('两次密码输入不一致');\n        return false;\n      }\n\n      this.axios.put('/api/admin/users/password', this.passwordForm).then(({\n        data\n      }) => {\n        if (data.code === 0) {\n          this.passwordForm.oldPassword = '';\n          this.passwordForm.newPassword = '';\n          this.passwordForm.confirmPassword = '';\n          this.$notify.success({\n            title: '成功',\n            message: '修改成功'\n          });\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: '修改失败'\n          });\n        }\n      });\n    }\n\n  },\n  computed: {\n    avatar() {\n      return this.$store.state.userInfo.avatar;\n    }\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}