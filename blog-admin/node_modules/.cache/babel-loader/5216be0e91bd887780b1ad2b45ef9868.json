{"ast":null,"code":"import * as imageConversion from 'image-conversion';\nexport default {\n  created() {\n    this.getWebsiteConfig();\n  },\n\n  data: function () {\n    return {\n      websiteConfigForm: {},\n      activeName: 'info',\n      headers: {\n        Authorization: 'Bearer ' + sessionStorage.getItem('token')\n      }\n    };\n  },\n  methods: {\n    getWebsiteConfig() {\n      this.axios.get('/api/admin/website/config').then(({\n        data\n      }) => {\n        this.websiteConfigForm = data.data;\n      });\n    },\n\n    handleAuthorAvatarSuccess(response) {\n      this.websiteConfigForm.authorAvatar = response.data;\n    },\n\n    handleFaviconSuccess(response) {\n      this.websiteConfigForm.favicon = response.data;\n    },\n\n    handleLogoSuccess(response) {\n      this.websiteConfigForm.logo = response.data;\n    },\n\n    handleUserAvatarSuccess(response) {\n      this.websiteConfigForm.userAvatar = response.data;\n    },\n\n    handleTouristAvatarSuccess(response) {\n      this.websiteConfigForm.touristAvatar = response.data;\n    },\n\n    handleWeiXinSuccess(response) {\n      this.websiteConfigForm.weiXinQRCode = response.data;\n    },\n\n    handleAlipaySuccess(response) {\n      this.websiteConfigForm.alipayQRCode = response.data;\n    },\n\n    beforeUpload(file) {\n      return new Promise(resolve => {\n        if (file.size / 1024 < this.config.UPLOAD_SIZE) {\n          resolve(file);\n        }\n\n        imageConversion.compressAccurately(file, this.config.UPLOAD_SIZE).then(res => {\n          resolve(res);\n        });\n      });\n    },\n\n    updateWebsiteConfig() {\n      this.axios.put('/api/admin/website/config', this.websiteConfigForm).then(({\n        data\n      }) => {\n        if (data.flag) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA+NA;AAEA;EACAA;IACA;EACA,CAHA;;EAIAC;IACA;MACAC,qBADA;MAEAC,kBAFA;MAGAC;QAAAC;MAAA;IAHA;EAKA,CAVA;EAWAC;IACAC;MACA;QAAAN;MAAA;QACA;MACA,CAFA;IAGA,CALA;;IAMAO;MACA;IACA,CARA;;IASAC;MACA;IACA,CAXA;;IAYAC;MACA;IACA,CAdA;;IAeAC;MACA;IACA,CAjBA;;IAkBAC;MACA;IACA,CApBA;;IAqBAC;MACA;IACA,CAvBA;;IAwBAC;MACA;IACA,CA1BA;;IA2BAC;MACA;QACA;UACAC;QACA;;QACAC;UACAD;QACA,CAFA;MAGA,CAPA;IAQA,CApCA;;IAqCAE;MACA;QAAAjB;MAAA;QACA;UACA;YACAkB,WADA;YAEAC;UAFA;QAIA,CALA,MAKA;UACA;YACAD,WADA;YAEAC;UAFA;QAIA;MACA,CAZA;IAaA;;EAnDA;AAXA","names":["created","data","websiteConfigForm","activeName","headers","Authorization","methods","getWebsiteConfig","handleAuthorAvatarSuccess","handleFaviconSuccess","handleLogoSuccess","handleUserAvatarSuccess","handleTouristAvatarSuccess","handleWeiXinSuccess","handleAlipaySuccess","beforeUpload","resolve","imageConversion","updateWebsiteConfig","title","message"],"sourceRoot":"src/views/website","sources":["Website.vue"],"sourcesContent":["<template>\n  <el-card class=\"main-card\">\n    <el-tabs v-model=\"activeName\">\n      <el-tab-pane label=\"网站信息\" name=\"info\">\n        <el-form label-width=\"100px\" :model=\"websiteConfigForm\" label-position=\"left\">\n          <el-form-item label=\"作者头像\">\n            <el-upload\n              class=\"avatar-uploader\"\n              action=\"/api/admin/config/images\"\n              :headers=\"headers\"\n              :show-file-list=\"false\"\n              :before-upload=\"beforeUpload\"\n              :on-success=\"handleAuthorAvatarSuccess\">\n              <img v-if=\"websiteConfigForm.authorAvatar\" :src=\"websiteConfigForm.authorAvatar\" class=\"avatar\" />\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\n            </el-upload>\n          </el-form-item>\n          <el-form-item label=\"网站logo\">\n            <el-upload\n              class=\"avatar-uploader\"\n              action=\"/api/admin/config/images\"\n              :headers=\"headers\"\n              :show-file-list=\"false\"\n              :before-upload=\"beforeUpload\"\n              :on-success=\"handleLogoSuccess\">\n              <img v-if=\"websiteConfigForm.logo\" :src=\"websiteConfigForm.logo\" class=\"avatar\" />\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\n            </el-upload>\n          </el-form-item>\n          <el-form-item label=\"favicon\">\n            <el-upload\n              class=\"avatar-uploader\"\n              action=\"/api/admin/config/images\"\n              :headers=\"headers\"\n              :show-file-list=\"false\"\n              :before-upload=\"beforeUpload\"\n              :on-success=\"handleFaviconSuccess\">\n              <img v-if=\"websiteConfigForm.favicon\" :src=\"websiteConfigForm.favicon\" class=\"avatar\" />\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\n            </el-upload>\n          </el-form-item>\n          <el-form-item label=\"网站名称\">\n            <el-input v-model=\"websiteConfigForm.name\" size=\"small\" style=\"width: 400px\" />\n          </el-form-item>\n          <el-form-item label=\"网站英文名称\">\n            <el-input v-model=\"websiteConfigForm.englishName\" size=\"small\" style=\"width: 400px\" />\n          </el-form-item>\n          <el-form-item label=\"网站作者\">\n            <el-input v-model=\"websiteConfigForm.author\" size=\"small\" style=\"width: 400px\" />\n          </el-form-item>\n          <el-form-item label=\"网页标题\">\n            <el-input v-model=\"websiteConfigForm.websiteTitle\" size=\"small\" style=\"width: 400px\" />\n          </el-form-item>\n          <el-form-item label=\"作者介绍\">\n            <el-input v-model=\"websiteConfigForm.authorIntro\" size=\"small\" style=\"width: 400px\" />\n          </el-form-item>\n          <el-form-item label=\"多语言\">\n            <el-radio-group v-model=\"websiteConfigForm.multiLanguage\">\n              <el-radio :label=\"0\">关闭</el-radio>\n              <el-radio :label=\"1\">开启</el-radio>\n            </el-radio-group>\n          </el-form-item>\n          <el-form-item label=\"网站创建日期\">\n            <el-date-picker\n              style=\"width: 400px\"\n              value-format=\"yyyy-MM-dd\"\n              v-model=\"websiteConfigForm.websiteCreateTime\"\n              type=\"date\"\n              placeholder=\"选择日期\" />\n          </el-form-item>\n          <el-form-item label=\"网站公告\">\n            <el-input\n              v-model=\"websiteConfigForm.notice\"\n              placeholder=\"请输入公告内容\"\n              style=\"width: 400px\"\n              type=\"textarea\"\n              :rows=\"5\" />\n          </el-form-item>\n          <el-form-item label=\"工信部备案号\">\n            <el-input v-model=\"websiteConfigForm.beianNumber\" size=\"small\" style=\"width: 400px\" />\n          </el-form-item>\n          <el-form-item label=\"公安部备案号\">\n            <el-input v-model=\"websiteConfigForm.gonganBeianNumber\" size=\"small\" style=\"width: 400px\" />\n          </el-form-item>\n          <el-form-item label=\"qq登录\">\n            <el-radio-group v-model=\"websiteConfigForm.qqLogin\">\n              <el-radio :label=\"0\">关闭</el-radio>\n              <el-radio :label=\"1\">开启</el-radio>\n            </el-radio-group>\n          </el-form-item>\n          <el-button type=\"primary\" size=\"medium\" style=\"margin-left: 6.3rem\" @click=\"updateWebsiteConfig\">\n            修改\n          </el-button>\n        </el-form>\n      </el-tab-pane>\n      <el-tab-pane label=\"社交信息\" name=\"notice\">\n        tip:空白默认不显示\n        <el-form label-width=\"70px\" :model=\"websiteConfigForm\">\n          <el-form-item label=\"Github\">\n            <el-input v-model=\"websiteConfigForm.github\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\n          </el-form-item>\n          <el-form-item label=\"Gitee\">\n            <el-input v-model=\"websiteConfigForm.gitee\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\n          </el-form-item>\n          <el-form-item label=\"QQ\">\n            <el-input v-model=\"websiteConfigForm.qq\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\n          </el-form-item>\n          <el-form-item label=\"WeChat\">\n            <el-input v-model=\"websiteConfigForm.weChat\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\n          </el-form-item>\n          <el-form-item label=\"微博\">\n            <el-input v-model=\"websiteConfigForm.weibo\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\n          </el-form-item>\n          <el-form-item label=\"CSDN\">\n            <el-input v-model=\"websiteConfigForm.csdn\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\n          </el-form-item>\n          <el-form-item label=\"知乎\">\n            <el-input v-model=\"websiteConfigForm.zhihu\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\n          </el-form-item>\n          <el-form-item label=\"掘金\">\n            <el-input v-model=\"websiteConfigForm.juejin\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\n          </el-form-item>\n          <el-form-item label=\"twitter\">\n            <el-input v-model=\"websiteConfigForm.twitter\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\n          </el-form-item>\n          <el-form-item label=\"stackoverflow\">\n            <el-input v-model=\"websiteConfigForm.stackoverflow\" size=\"small\" style=\"width: 400px; margin-right: 1rem\" />\n          </el-form-item>\n          <el-button type=\"primary\" size=\"medium\" style=\"margin-left: 4.375rem\" @click=\"updateWebsiteConfig\">\n            修改\n          </el-button>\n        </el-form>\n      </el-tab-pane>\n      <el-tab-pane label=\"其他设置\" name=\"password\">\n        <el-form label-width=\"120px\" :model=\"websiteConfigForm\" label-position=\"left\">\n          <el-row style=\"width: 600px\">\n            <el-col :md=\"12\">\n              <el-form-item label=\"用户头像\">\n                <el-upload\n                  class=\"avatar-uploader\"\n                  action=\"/api/admin/config/images\"\n                  :headers=\"headers\"\n                  :show-file-list=\"false\"\n                  :before-upload=\"beforeUpload\"\n                  :on-success=\"handleUserAvatarSuccess\">\n                  <img v-if=\"websiteConfigForm.userAvatar\" :src=\"websiteConfigForm.userAvatar\" class=\"avatar\" />\n                  <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\n                </el-upload>\n              </el-form-item>\n            </el-col>\n            <el-col :md=\"12\">\n              <el-form-item label=\"游客头像\">\n                <el-upload\n                  class=\"avatar-uploader\"\n                  action=\"/api/admin/config/images\"\n                  :headers=\"headers\"\n                  :show-file-list=\"false\"\n                  :before-upload=\"beforeUpload\"\n                  :on-success=\"handleTouristAvatarSuccess\">\n                  <img v-if=\"websiteConfigForm.touristAvatar\" :src=\"websiteConfigForm.touristAvatar\" class=\"avatar\" />\n                  <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\n                </el-upload>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-form-item label=\"邮箱通知\">\n            <el-radio-group v-model=\"websiteConfigForm.isEmailNotice\">\n              <el-radio :label=\"1\">开启</el-radio>\n              <el-radio :label=\"0\">关闭</el-radio>\n            </el-radio-group>\n          </el-form-item>\n          <el-form-item label=\"评论审核\">\n            <el-radio-group v-model=\"websiteConfigForm.isCommentReview\">\n              <el-radio :label=\"1\">开启</el-radio>\n              <el-radio :label=\"0\">关闭</el-radio>\n            </el-radio-group>\n          </el-form-item>\n          <el-form-item label=\"打赏状态\">\n            <el-radio-group v-model=\"websiteConfigForm.isReward\">\n              <el-radio :label=\"1\">开启</el-radio>\n              <el-radio :label=\"0\">关闭</el-radio>\n            </el-radio-group>\n          </el-form-item>\n          <el-row style=\"width: 600px\" v-show=\"websiteConfigForm.isReward == 1\">\n            <el-col :md=\"12\">\n              <el-form-item label=\"微信收款码\">\n                <el-upload\n                  class=\"avatar-uploader\"\n                  action=\"/api/admin/config/images\"\n                  :headers=\"headers\"\n                  :show-file-list=\"false\"\n                  :before-upload=\"beforeUpload\"\n                  :on-success=\"handleWeiXinSuccess\">\n                  <img v-if=\"websiteConfigForm.weiXinQRCode\" :src=\"websiteConfigForm.weiXinQRCode\" class=\"avatar\" />\n                  <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\n                </el-upload>\n              </el-form-item>\n            </el-col>\n            <el-col :md=\"12\">\n              <el-form-item label=\"支付宝收款码\">\n                <el-upload\n                  class=\"avatar-uploader\"\n                  action=\"/api/admin/config/images\"\n                  :headers=\"headers\"\n                  :show-file-list=\"false\"\n                  :before-upload=\"beforeUpload\"\n                  :on-success=\"handleAlipaySuccess\">\n                  <img v-if=\"websiteConfigForm.alipayQRCode\" :src=\"websiteConfigForm.alipayQRCode\" class=\"avatar\" />\n                  <i v-else class=\"el-icon-plus avatar-uploader-icon\" />\n                </el-upload>\n              </el-form-item>\n            </el-col>\n          </el-row>\n          <el-button type=\"primary\" size=\"medium\" style=\"margin-left: 6.3rem\" @click=\"updateWebsiteConfig\">\n            修改\n          </el-button>\n        </el-form>\n      </el-tab-pane>\n    </el-tabs>\n  </el-card>\n</template>\n\n<script>\nimport * as imageConversion from 'image-conversion'\n\nexport default {\n  created() {\n    this.getWebsiteConfig()\n  },\n  data: function () {\n    return {\n      websiteConfigForm: {},\n      activeName: 'info',\n      headers: { Authorization: 'Bearer ' + sessionStorage.getItem('token') }\n    }\n  },\n  methods: {\n    getWebsiteConfig() {\n      this.axios.get('/api/admin/website/config').then(({ data }) => {\n        this.websiteConfigForm = data.data\n      })\n    },\n    handleAuthorAvatarSuccess(response) {\n      this.websiteConfigForm.authorAvatar = response.data\n    },\n    handleFaviconSuccess(response) {\n      this.websiteConfigForm.favicon = response.data\n    },\n    handleLogoSuccess(response) {\n      this.websiteConfigForm.logo = response.data\n    },\n    handleUserAvatarSuccess(response) {\n      this.websiteConfigForm.userAvatar = response.data\n    },\n    handleTouristAvatarSuccess(response) {\n      this.websiteConfigForm.touristAvatar = response.data\n    },\n    handleWeiXinSuccess(response) {\n      this.websiteConfigForm.weiXinQRCode = response.data\n    },\n    handleAlipaySuccess(response) {\n      this.websiteConfigForm.alipayQRCode = response.data\n    },\n    beforeUpload(file) {\n      return new Promise((resolve) => {\n        if (file.size / 1024 < this.config.UPLOAD_SIZE) {\n          resolve(file)\n        }\n        imageConversion.compressAccurately(file, this.config.UPLOAD_SIZE).then((res) => {\n          resolve(res)\n        })\n      })\n    },\n    updateWebsiteConfig() {\n      this.axios.put('/api/admin/website/config', this.websiteConfigForm).then(({ data }) => {\n        if (data.flag) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          })\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          })\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style>\n.avatar-uploader .el-upload {\n  border: 1px dashed #d9d9d9;\n  border-radius: 6px;\n  cursor: pointer;\n  position: relative;\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\n  border-color: #409eff;\n}\n.avatar-uploader-icon {\n  font-size: 28px;\n  color: #8c939d;\n  width: 120px;\n  height: 120px;\n  line-height: 120px;\n  text-align: center;\n}\n.avatar {\n  width: 120px;\n  height: 120px;\n  display: block;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}