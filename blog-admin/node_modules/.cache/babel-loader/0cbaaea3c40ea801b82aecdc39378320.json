{"ast":null,"code":"export default {\n  created() {\n    this.listResources();\n  },\n\n  data() {\n    return {\n      loading: true,\n      keywords: '',\n      resources: [],\n      addModule: false,\n      addResource: false,\n      resourceForm: {}\n    };\n  },\n\n  methods: {\n    listResources() {\n      this.axios.get('/api/admin/resources', {\n        params: {\n          keywords: this.keywords\n        }\n      }).then(({\n        data\n      }) => {\n        this.resources = data.data;\n        this.loading = false;\n      });\n    },\n\n    changeResource(resource) {\n      this.axios.post('/api/admin/resources', resource).then(({\n        data\n      }) => {\n        if (data.code === 0) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n          this.listResources();\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n      });\n    },\n\n    openModel(resource) {\n      if (resource != null) {\n        this.resourceForm = JSON.parse(JSON.stringify(resource));\n        this.$refs.moduleTitle.innerHTML = '修改模块';\n      } else {\n        this.resourceForm = {};\n        this.$refs.moduleTitle.innerHTML = '添加模块';\n      }\n\n      this.addModule = true;\n    },\n\n    openEditResourceModel(resource) {\n      if (resource.url == null) {\n        this.openModel(resource);\n        return false;\n      }\n\n      this.resourceForm = JSON.parse(JSON.stringify(resource));\n      this.$refs.resourceTitle.innerHTML = '修改资源';\n      this.addResource = true;\n    },\n\n    openAddResourceModel(resource) {\n      console.log(resource);\n      this.resourceForm = {};\n      this.resourceForm.parentId = resource.id;\n      this.$refs.resourceTitle.innerHTML = '添加资源';\n      this.addResource = true;\n    },\n\n    deleteResource(id) {\n      this.axios.delete('/api/admin/resources/' + id).then(({\n        data\n      }) => {\n        if (data.code === 0) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n          this.listResources();\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n      });\n    },\n\n    addOrEditResource() {\n      if (this.resourceForm.resourceName.trim() == '') {\n        this.$message.error('资源名不能为空');\n        return false;\n      }\n\n      this.axios.post('/api/admin/resources', this.resourceForm).then(({\n        data\n      }) => {\n        if (data.code === 0) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n          this.listResources();\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n\n        this.addModule = false;\n        this.addResource = false;\n      });\n    }\n\n  },\n  computed: {\n    tagType() {\n      return function (type) {\n        switch (type) {\n          case 'GET':\n            return '';\n\n          case 'POST':\n            return 'success';\n\n          case 'PUT':\n            return 'warning';\n\n          case 'DELETE':\n            return 'danger';\n        }\n      };\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAuGA;EACAA;IACA;EACA,CAHA;;EAIAC;IACA;MACAC,aADA;MAEAC,YAFA;MAGAC,aAHA;MAIAC,gBAJA;MAKAC,kBALA;MAMAC;IANA;EAQA,CAbA;;EAcAC;IACAC;MACA,WACAC,GADA,CACA,sBADA,EACA;QACAC;UACAR;QADA;MADA,CADA,EAMAS,IANA,CAMA;QAAAX;MAAA;QACA;QACA;MACA,CATA;IAUA,CAZA;;IAaAY;MACA;QAAAZ;MAAA;QACA;UACA;YACAa,WADA;YAEAC;UAFA;UAIA;QACA,CANA,MAMA;UACA;YACAD,WADA;YAEAC;UAFA;QAIA;MACA,CAbA;IAcA,CA5BA;;IA6BAC;MACA;QACA;QACA;MACA,CAHA,MAGA;QACA;QACA;MACA;;MACA;IACA,CAtCA;;IAuCAC;MACA;QACA;QACA;MACA;;MACA;MACA;MACA;IACA,CA/CA;;IAgDAC;MACAC;MACA;MACA;MACA;MACA;IACA,CAtDA;;IAuDAC;MACA;QAAAnB;MAAA;QACA;UACA;YACAa,WADA;YAEAC;UAFA;UAIA;QACA,CANA,MAMA;UACA;YACAD,WADA;YAEAC;UAFA;QAIA;MACA,CAbA;IAcA,CAtEA;;IAuEAM;MACA;QACA;QACA;MACA;;MACA;QAAApB;MAAA;QACA;UACA;YACAa,WADA;YAEAC;UAFA;UAIA;QACA,CANA,MAMA;UACA;YACAD,WADA;YAEAC;UAFA;QAIA;;QACA;QACA;MACA,CAfA;IAgBA;;EA5FA,CAdA;EA4GAO;IACAC;MACA;QACA;UACA;YACA;;UACA;YACA;;UACA;YACA;;UACA;YACA;QARA;MAUA,CAXA;IAYA;;EAdA;AA5GA","names":["created","data","loading","keywords","resources","addModule","addResource","resourceForm","methods","listResources","get","params","then","changeResource","title","message","openModel","openEditResourceModel","openAddResourceModel","console","deleteResource","addOrEditResource","computed","tagType"],"sourceRoot":"src/views/resource","sources":["Resource.vue"],"sourcesContent":["<template>\n  <el-card class=\"main-card\">\n    <div class=\"title\">{{ this.$route.name }}</div>\n    <div class=\"operation-container\">\n      <el-button type=\"primary\" size=\"small\" icon=\"el-icon-plus\" @click=\"openModel(null)\"> 新增模块 </el-button>\n      <div style=\"margin-left: auto\">\n        <el-input\n          v-model=\"keywords\"\n          prefix-icon=\"el-icon-search\"\n          size=\"small\"\n          placeholder=\"请输入资源名\"\n          style=\"width: 200px\"\n          @keyup.enter.native=\"listResources\" />\n        <el-button type=\"primary\" size=\"small\" icon=\"el-icon-search\" style=\"margin-left: 1rem\" @click=\"listResources\">\n          搜索\n        </el-button>\n      </div>\n    </div>\n    <el-table\n      v-loading=\"loading\"\n      :data=\"resources\"\n      row-key=\"id\"\n      :tree-props=\"{ children: 'children', hasChildren: 'hasChildren' }\">\n      <el-table-column prop=\"resourceName\" label=\"资源名\" width=\"220\" />\n      <el-table-column prop=\"url\" label=\"资源路径\" width=\"300\" />\n      <el-table-column prop=\"requetMethod\" label=\"请求方式\">\n        <template slot-scope=\"scope\" v-if=\"scope.row.requestMethod\">\n          <el-tag :type=\"tagType(scope.row.requestMethod)\">\n            {{ scope.row.requestMethod }}\n          </el-tag>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"isAnonymous\" label=\"匿名访问\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <el-switch\n            v-if=\"scope.row.url\"\n            v-model=\"scope.row.isAnonymous\"\n            active-color=\"#13ce66\"\n            inactive-color=\"#F4F4F5\"\n            :active-value=\"1\"\n            :inactive-value=\"0\"\n            @change=\"changeResource(scope.row)\" />\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"createTime\" label=\"创建时间\" align=\"center\">\n        <template slot-scope=\"scope\">\n          <i class=\"el-icon-time\" style=\"margin-right: 5px\" />\n          {{ scope.row.createTime | date }}\n        </template>\n      </el-table-column>\n      <el-table-column label=\"操作\" align=\"center\" width=\"200\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"text\" size=\"mini\" @click=\"openAddResourceModel(scope.row)\" v-if=\"scope.row.children\">\n            <i class=\"el-icon-plus\" /> 新增\n          </el-button>\n          <el-button type=\"text\" size=\"mini\" @click=\"openEditResourceModel(scope.row)\">\n            <i class=\"el-icon-edit\" /> 修改\n          </el-button>\n          <el-popconfirm title=\"确定删除吗？\" style=\"margin-left: 10px\" @confirm=\"deleteResource(scope.row.id)\">\n            <el-button size=\"mini\" type=\"text\" slot=\"reference\"> <i class=\"el-icon-delete\" /> 删除 </el-button>\n          </el-popconfirm>\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-dialog :visible.sync=\"addModule\" width=\"30%\">\n      <div class=\"dialog-title-container\" slot=\"title\" ref=\"moduleTitle\" />\n      <el-form label-width=\"80px\" size=\"medium\" :model=\"resourceForm\">\n        <el-form-item label=\"模块名\">\n          <el-input v-model=\"resourceForm.resourceName\" style=\"width: 220px\" />\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"addModule = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"addOrEditResource\"> 确 定 </el-button>\n      </span>\n    </el-dialog>\n    <el-dialog :visible.sync=\"addResource\" width=\"30%\">\n      <div class=\"dialog-title-container\" slot=\"title\" ref=\"resourceTitle\" />\n      <el-form label-width=\"80px\" size=\"medium\" :model=\"resourceForm\">\n        <el-form-item label=\"资源名\">\n          <el-input v-model=\"resourceForm.resourceName\" style=\"width: 220px\" />\n        </el-form-item>\n        <el-form-item label=\"资源路径\">\n          <el-input v-model=\"resourceForm.url\" style=\"width: 220px\" />\n        </el-form-item>\n        <el-form-item label=\"请求方式\">\n          <el-radio-group v-model=\"resourceForm.requestMethod\">\n            <el-radio :label=\"'GET'\">GET</el-radio>\n            <el-radio :label=\"'POST'\">POST</el-radio>\n            <el-radio :label=\"'PUT'\">PUT</el-radio>\n            <el-radio :label=\"'DELETE'\">DELETE</el-radio>\n          </el-radio-group>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"addResource = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"addOrEditResource\"> 确 定 </el-button>\n      </span>\n    </el-dialog>\n  </el-card>\n</template>\n\n<script>\nexport default {\n  created() {\n    this.listResources()\n  },\n  data() {\n    return {\n      loading: true,\n      keywords: '',\n      resources: [],\n      addModule: false,\n      addResource: false,\n      resourceForm: {}\n    }\n  },\n  methods: {\n    listResources() {\n      this.axios\n        .get('/api/admin/resources', {\n          params: {\n            keywords: this.keywords\n          }\n        })\n        .then(({ data }) => {\n          this.resources = data.data\n          this.loading = false\n        })\n    },\n    changeResource(resource) {\n      this.axios.post('/api/admin/resources', resource).then(({ data }) => {\n        if (data.code === 0) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          })\n          this.listResources()\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          })\n        }\n      })\n    },\n    openModel(resource) {\n      if (resource != null) {\n        this.resourceForm = JSON.parse(JSON.stringify(resource))\n        this.$refs.moduleTitle.innerHTML = '修改模块'\n      } else {\n        this.resourceForm = {}\n        this.$refs.moduleTitle.innerHTML = '添加模块'\n      }\n      this.addModule = true\n    },\n    openEditResourceModel(resource) {\n      if (resource.url == null) {\n        this.openModel(resource)\n        return false\n      }\n      this.resourceForm = JSON.parse(JSON.stringify(resource))\n      this.$refs.resourceTitle.innerHTML = '修改资源'\n      this.addResource = true\n    },\n    openAddResourceModel(resource) {\n      console.log(resource)\n      this.resourceForm = {}\n      this.resourceForm.parentId = resource.id\n      this.$refs.resourceTitle.innerHTML = '添加资源'\n      this.addResource = true\n    },\n    deleteResource(id) {\n      this.axios.delete('/api/admin/resources/' + id).then(({ data }) => {\n        if (data.code === 0) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          })\n          this.listResources()\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          })\n        }\n      })\n    },\n    addOrEditResource() {\n      if (this.resourceForm.resourceName.trim() == '') {\n        this.$message.error('资源名不能为空')\n        return false\n      }\n      this.axios.post('/api/admin/resources', this.resourceForm).then(({ data }) => {\n        if (data.code === 0) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          })\n          this.listResources()\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          })\n        }\n        this.addModule = false\n        this.addResource = false\n      })\n    }\n  },\n  computed: {\n    tagType() {\n      return function (type) {\n        switch (type) {\n          case 'GET':\n            return ''\n          case 'POST':\n            return 'success'\n          case 'PUT':\n            return 'warning'\n          case 'DELETE':\n            return 'danger'\n        }\n      }\n    }\n  }\n}\n</script>\n"]},"metadata":{},"sourceType":"module"}