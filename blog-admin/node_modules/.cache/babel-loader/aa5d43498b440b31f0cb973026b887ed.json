{"ast":null,"code":"export default {\n  created() {\n    this.current = this.$store.state.pageState.user;\n    this.listUsers();\n    this.listRoles();\n  },\n\n  data: function () {\n    return {\n      loading: true,\n      isEdit: false,\n      userForm: {\n        userInfoId: null,\n        nickname: ''\n      },\n      loginType: null,\n      userRoles: [],\n      roleIds: [],\n      userList: [],\n      typeList: [{\n        type: 1,\n        desc: '邮箱'\n      }, {\n        type: 2,\n        desc: 'QQ'\n      }],\n      keywords: null,\n      current: 1,\n      size: 10,\n      total: 0\n    };\n  },\n  methods: {\n    searchUsers() {\n      this.current = 1;\n      this.listUsers();\n    },\n\n    sizeChange(size) {\n      this.size = size;\n      this.listUsers();\n    },\n\n    currentChange(current) {\n      this.current = current;\n      this.$store.commit('updateUserPageState', current);\n      this.listUsers();\n    },\n\n    changeDisable(user) {\n      this.axios.put('/api/admin/users/disable', {\n        id: user.userInfoId,\n        isDisable: user.isDisable\n      });\n    },\n\n    openEditModel(user) {\n      this.roleIds = [];\n      this.userForm = JSON.parse(JSON.stringify(user));\n      this.userForm.roles.forEach(item => {\n        this.roleIds.push(item.id);\n      });\n      this.isEdit = true;\n    },\n\n    editUserRole() {\n      this.userForm.roleIds = this.roleIds;\n      console.log(this.userForm);\n      this.axios.put('/api/admin/users/role', this.userForm).then(({\n        data\n      }) => {\n        if (data.code === 0) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n          this.listUsers();\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n\n        this.isEdit = false;\n      });\n    },\n\n    listUsers() {\n      this.axios.get('/api/admin/users', {\n        params: {\n          current: this.current,\n          size: this.size,\n          keywords: this.keywords,\n          loginType: this.loginType\n        }\n      }).then(({\n        data\n      }) => {\n        this.userList = data.data.records;\n        this.total = data.data.total;\n        this.loading = false;\n      });\n    },\n\n    listRoles() {\n      this.axios.get('/api/admin/users/role').then(({\n        data\n      }) => {\n        this.userRoles = data.data;\n      });\n    }\n\n  },\n  watch: {\n    loginType() {\n      this.current = 1;\n      this.listUsers();\n    }\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}