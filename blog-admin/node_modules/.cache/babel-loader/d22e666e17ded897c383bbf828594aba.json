{"ast":null,"code":"export default {\n  created() {\n    this.current = this.$store.state.pageState.comment;\n    this.listComments();\n  },\n\n  data: function () {\n    return {\n      loading: true,\n      remove: false,\n      options: [{\n        value: 1,\n        label: '文章'\n      }, {\n        value: 2,\n        label: '留言'\n      }, {\n        value: 3,\n        label: '关于我'\n      }, {\n        value: 4,\n        label: '友链'\n      }],\n      comments: [],\n      commentIds: [],\n      type: null,\n      keywords: null,\n      isReview: null,\n      current: 1,\n      size: 10,\n      total: 0\n    };\n  },\n  methods: {\n    selectionChange(comments) {\n      this.commentIds = [];\n      comments.forEach(item => {\n        this.commentIds.push(item.id);\n      });\n    },\n\n    searchComments() {\n      this.current = 1;\n      this.listComments();\n    },\n\n    sizeChange(size) {\n      this.size = size;\n      this.listComments();\n    },\n\n    currentChange(current) {\n      this.current = current;\n      this.$store.commit('updateCommentPageState', current);\n      this.listComments();\n    },\n\n    changeReview(review) {\n      this.current = 1;\n      this.isReview = review;\n    },\n\n    updateCommentReview(id) {\n      let param = {};\n\n      if (id != null) {\n        param.ids = [id];\n      } else {\n        param.ids = this.commentIds;\n      }\n\n      param.isReview = 1;\n      this.axios.put('/api/admin/comments/review', param).then(({\n        data\n      }) => {\n        if (data.code === 0) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n          this.listComments();\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n      });\n    },\n\n    deleteComments(id) {\n      var param = {};\n\n      if (id == null) {\n        param = {\n          data: this.commentIds\n        };\n      } else {\n        param = {\n          data: [id]\n        };\n      }\n\n      this.axios.delete('/api/admin/comments', param).then(({\n        data\n      }) => {\n        if (data.code === 0) {\n          this.$notify.success({\n            title: '成功',\n            message: data.message\n          });\n          this.listComments();\n        } else {\n          this.$notify.error({\n            title: '失败',\n            message: data.message\n          });\n        }\n\n        this.remove = false;\n      });\n    },\n\n    listComments() {\n      this.axios.get('/api/admin/comments', {\n        params: {\n          current: this.current,\n          size: this.size,\n          keywords: this.keywords,\n          type: this.type,\n          isReview: this.isReview\n        }\n      }).then(({\n        data\n      }) => {\n        this.comments = data.data.records;\n        this.total = data.data.total;\n        this.loading = false;\n      });\n    }\n\n  },\n  watch: {\n    isReview() {\n      this.current = 1;\n      this.listComments();\n    },\n\n    type() {\n      this.current = 1;\n      this.listComments();\n    }\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}