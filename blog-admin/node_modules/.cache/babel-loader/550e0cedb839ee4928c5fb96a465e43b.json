{"ast":null,"code":"export default {\n  data() {\n    return {\n      dayRule: '',\n      dayRuleSup: '',\n      dateArr: [],\n      resultList: [],\n      isShow: false\n    };\n  },\n\n  name: 'crontab-result',\n  methods: {\n    expressionChange() {\n      this.isShow = false;\n      let ruleArr = this.$options.propsData.ex.split(' ');\n      let nums = 0;\n      let resultArr = [];\n      let nTime = new Date();\n      let nYear = nTime.getFullYear();\n      let nMonth = nTime.getMonth() + 1;\n      let nDay = nTime.getDate();\n      let nHour = nTime.getHours();\n      let nMin = nTime.getMinutes();\n      let nSecond = nTime.getSeconds();\n      this.getSecondArr(ruleArr[0]);\n      this.getMinArr(ruleArr[1]);\n      this.getHourArr(ruleArr[2]);\n      this.getDayArr(ruleArr[3]);\n      this.getMonthArr(ruleArr[4]);\n      this.getWeekArr(ruleArr[5]);\n      this.getYearArr(ruleArr[6], nYear);\n      let sDate = this.dateArr[0];\n      let mDate = this.dateArr[1];\n      let hDate = this.dateArr[2];\n      let DDate = this.dateArr[3];\n      let MDate = this.dateArr[4];\n      let YDate = this.dateArr[5];\n      let sIdx = this.getIndex(sDate, nSecond);\n      let mIdx = this.getIndex(mDate, nMin);\n      let hIdx = this.getIndex(hDate, nHour);\n      let DIdx = this.getIndex(DDate, nDay);\n      let MIdx = this.getIndex(MDate, nMonth);\n      let YIdx = this.getIndex(YDate, nYear);\n\n      const resetSecond = function () {\n        sIdx = 0;\n        nSecond = sDate[sIdx];\n      };\n\n      const resetMin = function () {\n        mIdx = 0;\n        nMin = mDate[mIdx];\n        resetSecond();\n      };\n\n      const resetHour = function () {\n        hIdx = 0;\n        nHour = hDate[hIdx];\n        resetMin();\n      };\n\n      const resetDay = function () {\n        DIdx = 0;\n        nDay = DDate[DIdx];\n        resetHour();\n      };\n\n      const resetMonth = function () {\n        MIdx = 0;\n        nMonth = MDate[MIdx];\n        resetDay();\n      };\n\n      if (nYear !== YDate[YIdx]) {\n        resetMonth();\n      }\n\n      if (nMonth !== MDate[MIdx]) {\n        resetDay();\n      }\n\n      if (nDay !== DDate[DIdx]) {\n        resetHour();\n      }\n\n      if (nHour !== hDate[hIdx]) {\n        resetMin();\n      }\n\n      if (nMin !== mDate[mIdx]) {\n        resetSecond();\n      }\n\n      goYear: for (let Yi = YIdx; Yi < YDate.length; Yi++) {\n        let YY = YDate[Yi];\n\n        if (nMonth > MDate[MDate.length - 1]) {\n          resetMonth();\n          continue;\n        }\n\n        goMonth: for (let Mi = MIdx; Mi < MDate.length; Mi++) {\n          let MM = MDate[Mi];\n          MM = MM < 10 ? '0' + MM : MM;\n\n          if (nDay > DDate[DDate.length - 1]) {\n            resetDay();\n\n            if (Mi == MDate.length - 1) {\n              resetMonth();\n              continue goYear;\n            }\n\n            continue;\n          }\n\n          goDay: for (let Di = DIdx; Di < DDate.length; Di++) {\n            let DD = DDate[Di];\n            let thisDD = DD < 10 ? '0' + DD : DD;\n\n            if (nHour > hDate[hDate.length - 1]) {\n              resetHour();\n\n              if (Di == DDate.length - 1) {\n                resetDay();\n\n                if (Mi == MDate.length - 1) {\n                  resetMonth();\n                  continue goYear;\n                }\n\n                continue goMonth;\n              }\n\n              continue;\n            }\n\n            if (this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true && this.dayRule !== 'workDay' && this.dayRule !== 'lastWeek' && this.dayRule !== 'lastDay') {\n              resetDay();\n              continue goMonth;\n            }\n\n            if (this.dayRule == 'lastDay') {\n              if (this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                while (DD > 0 && this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                  DD--;\n                  thisDD = DD < 10 ? '0' + DD : DD;\n                }\n              }\n            } else if (this.dayRule == 'workDay') {\n              if (this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                while (DD > 0 && this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                  DD--;\n                  thisDD = DD < 10 ? '0' + DD : DD;\n                }\n              }\n\n              let thisWeek = this.formatDate(new Date(YY + '-' + MM + '-' + thisDD + ' 00:00:00'), 'week');\n\n              if (thisWeek == 1) {\n                DD++;\n                thisDD = DD < 10 ? '0' + DD : DD;\n\n                if (this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                  DD -= 3;\n                }\n              } else if (thisWeek == 7) {\n                if (this.dayRuleSup !== 1) {\n                  DD--;\n                } else {\n                  DD += 2;\n                }\n              }\n            } else if (this.dayRule == 'weekDay') {\n              let thisWeek = this.formatDate(new Date(YY + '-' + MM + '-' + DD + ' 00:00:00'), 'week');\n\n              if (this.dayRuleSup.indexOf(thisWeek) < 0) {\n                if (Di == DDate.length - 1) {\n                  resetDay();\n\n                  if (Mi == MDate.length - 1) {\n                    resetMonth();\n                    continue goYear;\n                  }\n\n                  continue goMonth;\n                }\n\n                continue;\n              }\n            } else if (this.dayRule == 'assWeek') {\n              let thisWeek = this.formatDate(new Date(YY + '-' + MM + '-' + DD + ' 00:00:00'), 'week');\n\n              if (this.dayRuleSup[1] >= thisWeek) {\n                DD = (this.dayRuleSup[0] - 1) * 7 + this.dayRuleSup[1] - thisWeek + 1;\n              } else {\n                DD = this.dayRuleSup[0] * 7 + this.dayRuleSup[1] - thisWeek + 1;\n              }\n            } else if (this.dayRule == 'lastWeek') {\n              if (this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                while (DD > 0 && this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                  DD--;\n                  thisDD = DD < 10 ? '0' + DD : DD;\n                }\n              }\n\n              let thisWeek = this.formatDate(new Date(YY + '-' + MM + '-' + thisDD + ' 00:00:00'), 'week');\n\n              if (this.dayRuleSup < thisWeek) {\n                DD -= thisWeek - this.dayRuleSup;\n              } else if (this.dayRuleSup > thisWeek) {\n                DD -= 7 - (this.dayRuleSup - thisWeek);\n              }\n            }\n\n            DD = DD < 10 ? '0' + DD : DD;\n\n            goHour: for (let hi = hIdx; hi < hDate.length; hi++) {\n              let hh = hDate[hi] < 10 ? '0' + hDate[hi] : hDate[hi];\n\n              if (nMin > mDate[mDate.length - 1]) {\n                resetMin();\n\n                if (hi == hDate.length - 1) {\n                  resetHour();\n\n                  if (Di == DDate.length - 1) {\n                    resetDay();\n\n                    if (Mi == MDate.length - 1) {\n                      resetMonth();\n                      continue goYear;\n                    }\n\n                    continue goMonth;\n                  }\n\n                  continue goDay;\n                }\n\n                continue;\n              }\n\n              goMin: for (let mi = mIdx; mi < mDate.length; mi++) {\n                let mm = mDate[mi] < 10 ? '0' + mDate[mi] : mDate[mi];\n\n                if (nSecond > sDate[sDate.length - 1]) {\n                  resetSecond();\n\n                  if (mi == mDate.length - 1) {\n                    resetMin();\n\n                    if (hi == hDate.length - 1) {\n                      resetHour();\n\n                      if (Di == DDate.length - 1) {\n                        resetDay();\n\n                        if (Mi == MDate.length - 1) {\n                          resetMonth();\n                          continue goYear;\n                        }\n\n                        continue goMonth;\n                      }\n\n                      continue goDay;\n                    }\n\n                    continue goHour;\n                  }\n\n                  continue;\n                }\n\n                goSecond: for (let si = sIdx; si <= sDate.length - 1; si++) {\n                  let ss = sDate[si] < 10 ? '0' + sDate[si] : sDate[si];\n\n                  if (MM !== '00' && DD !== '00') {\n                    resultArr.push(YY + '-' + MM + '-' + DD + ' ' + hh + ':' + mm + ':' + ss);\n                    nums++;\n                  }\n\n                  if (nums == 5) break goYear;\n\n                  if (si == sDate.length - 1) {\n                    resetSecond();\n\n                    if (mi == mDate.length - 1) {\n                      resetMin();\n\n                      if (hi == hDate.length - 1) {\n                        resetHour();\n\n                        if (Di == DDate.length - 1) {\n                          resetDay();\n\n                          if (Mi == MDate.length - 1) {\n                            resetMonth();\n                            continue goYear;\n                          }\n\n                          continue goMonth;\n                        }\n\n                        continue goDay;\n                      }\n\n                      continue goHour;\n                    }\n\n                    continue goMin;\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      if (resultArr.length == 0) {\n        this.resultList = ['没有达到条件的结果！'];\n      } else {\n        this.resultList = resultArr;\n\n        if (resultArr.length !== 5) {\n          this.resultList.push('最近100年内只有上面' + resultArr.length + '条结果！');\n        }\n      }\n\n      this.isShow = true;\n    },\n\n    getIndex(arr, value) {\n      if (value <= arr[0] || value > arr[arr.length - 1]) {\n        return 0;\n      } else {\n        for (let i = 0; i < arr.length - 1; i++) {\n          if (value > arr[i] && value <= arr[i + 1]) {\n            return i + 1;\n          }\n        }\n      }\n    },\n\n    getYearArr(rule, year) {\n      this.dateArr[5] = this.getOrderArr(year, year + 100);\n\n      if (rule !== undefined) {\n        if (rule.indexOf('-') >= 0) {\n          this.dateArr[5] = this.getCycleArr(rule, year + 100, false);\n        } else if (rule.indexOf('/') >= 0) {\n          this.dateArr[5] = this.getAverageArr(rule, year + 100);\n        } else if (rule !== '*') {\n          this.dateArr[5] = this.getAssignArr(rule);\n        }\n      }\n    },\n\n    getMonthArr(rule) {\n      this.dateArr[4] = this.getOrderArr(1, 12);\n\n      if (rule.indexOf('-') >= 0) {\n        this.dateArr[4] = this.getCycleArr(rule, 12, false);\n      } else if (rule.indexOf('/') >= 0) {\n        this.dateArr[4] = this.getAverageArr(rule, 12);\n      } else if (rule !== '*') {\n        this.dateArr[4] = this.getAssignArr(rule);\n      }\n    },\n\n    getWeekArr(rule) {\n      if (this.dayRule == '' && this.dayRuleSup == '') {\n        if (rule.indexOf('-') >= 0) {\n          this.dayRule = 'weekDay';\n          this.dayRuleSup = this.getCycleArr(rule, 7, false);\n        } else if (rule.indexOf('#') >= 0) {\n          this.dayRule = 'assWeek';\n          let matchRule = rule.match(/[0-9]{1}/g);\n          this.dayRuleSup = [Number(matchRule[1]), Number(matchRule[0])];\n          this.dateArr[3] = [1];\n\n          if (this.dayRuleSup[1] == 7) {\n            this.dayRuleSup[1] = 0;\n          }\n        } else if (rule.indexOf('L') >= 0) {\n          this.dayRule = 'lastWeek';\n          this.dayRuleSup = Number(rule.match(/[0-9]{1,2}/g)[0]);\n          this.dateArr[3] = [31];\n\n          if (this.dayRuleSup == 7) {\n            this.dayRuleSup = 0;\n          }\n        } else if (rule !== '*' && rule !== '?') {\n          this.dayRule = 'weekDay';\n          this.dayRuleSup = this.getAssignArr(rule);\n        }\n      }\n    },\n\n    getDayArr(rule) {\n      this.dateArr[3] = this.getOrderArr(1, 31);\n      this.dayRule = '';\n      this.dayRuleSup = '';\n\n      if (rule.indexOf('-') >= 0) {\n        this.dateArr[3] = this.getCycleArr(rule, 31, false);\n        this.dayRuleSup = 'null';\n      } else if (rule.indexOf('/') >= 0) {\n        this.dateArr[3] = this.getAverageArr(rule, 31);\n        this.dayRuleSup = 'null';\n      } else if (rule.indexOf('W') >= 0) {\n        this.dayRule = 'workDay';\n        this.dayRuleSup = Number(rule.match(/[0-9]{1,2}/g)[0]);\n        this.dateArr[3] = [this.dayRuleSup];\n      } else if (rule.indexOf('L') >= 0) {\n        this.dayRule = 'lastDay';\n        this.dayRuleSup = 'null';\n        this.dateArr[3] = [31];\n      } else if (rule !== '*' && rule !== '?') {\n        this.dateArr[3] = this.getAssignArr(rule);\n        this.dayRuleSup = 'null';\n      } else if (rule == '*') {\n        this.dayRuleSup = 'null';\n      }\n    },\n\n    getHourArr(rule) {\n      this.dateArr[2] = this.getOrderArr(0, 23);\n\n      if (rule.indexOf('-') >= 0) {\n        this.dateArr[2] = this.getCycleArr(rule, 24, true);\n      } else if (rule.indexOf('/') >= 0) {\n        this.dateArr[2] = this.getAverageArr(rule, 23);\n      } else if (rule !== '*') {\n        this.dateArr[2] = this.getAssignArr(rule);\n      }\n    },\n\n    getMinArr(rule) {\n      this.dateArr[1] = this.getOrderArr(0, 59);\n\n      if (rule.indexOf('-') >= 0) {\n        this.dateArr[1] = this.getCycleArr(rule, 60, true);\n      } else if (rule.indexOf('/') >= 0) {\n        this.dateArr[1] = this.getAverageArr(rule, 59);\n      } else if (rule !== '*') {\n        this.dateArr[1] = this.getAssignArr(rule);\n      }\n    },\n\n    getSecondArr(rule) {\n      this.dateArr[0] = this.getOrderArr(0, 59);\n\n      if (rule.indexOf('-') >= 0) {\n        this.dateArr[0] = this.getCycleArr(rule, 60, true);\n      } else if (rule.indexOf('/') >= 0) {\n        this.dateArr[0] = this.getAverageArr(rule, 59);\n      } else if (rule !== '*') {\n        this.dateArr[0] = this.getAssignArr(rule);\n      }\n    },\n\n    getOrderArr(min, max) {\n      let arr = [];\n\n      for (let i = min; i <= max; i++) {\n        arr.push(i);\n      }\n\n      return arr;\n    },\n\n    getAssignArr(rule) {\n      let arr = [];\n      let assiginArr = rule.split(',');\n\n      for (let i = 0; i < assiginArr.length; i++) {\n        arr[i] = Number(assiginArr[i]);\n      }\n\n      arr.sort(this.compare);\n      return arr;\n    },\n\n    getAverageArr(rule, limit) {\n      let arr = [];\n      let agArr = rule.split('/');\n      let min = Number(agArr[0]);\n      let step = Number(agArr[1]);\n\n      while (min <= limit) {\n        arr.push(min);\n        min += step;\n      }\n\n      return arr;\n    },\n\n    getCycleArr(rule, limit, status) {\n      let arr = [];\n      let cycleArr = rule.split('-');\n      let min = Number(cycleArr[0]);\n      let max = Number(cycleArr[1]);\n\n      if (min > max) {\n        max += limit;\n      }\n\n      for (let i = min; i <= max; i++) {\n        let add = 0;\n\n        if (status == false && i % limit == 0) {\n          add = limit;\n        }\n\n        arr.push(Math.round(i % limit + add));\n      }\n\n      arr.sort(this.compare);\n      return arr;\n    },\n\n    compare(value1, value2) {\n      if (value2 - value1 > 0) {\n        return -1;\n      } else {\n        return 1;\n      }\n    },\n\n    formatDate(value, type) {\n      let time = typeof value == 'number' ? new Date(value) : value;\n      let Y = time.getFullYear();\n      let M = time.getMonth() + 1;\n      let D = time.getDate();\n      let h = time.getHours();\n      let m = time.getMinutes();\n      let s = time.getSeconds();\n      let week = time.getDay();\n\n      if (type == undefined) {\n        return Y + '-' + (M < 10 ? '0' + M : M) + '-' + (D < 10 ? '0' + D : D) + ' ' + (h < 10 ? '0' + h : h) + ':' + (m < 10 ? '0' + m : m) + ':' + (s < 10 ? '0' + s : s);\n      } else if (type == 'week') {\n        return week + 1;\n      }\n    },\n\n    checkDate(value) {\n      let time = new Date(value);\n      let format = this.formatDate(time);\n      return value === format;\n    }\n\n  },\n  watch: {\n    ex: 'expressionChange'\n  },\n  props: ['ex'],\n  mounted: function () {\n    this.expressionChange();\n  }\n};","map":{"version":3,"mappings":"AAaA;EACAA;IACA;MACAC,WADA;MAEAC,cAFA;MAGAC,WAHA;MAIAC,cAJA;MAKAC;IALA;EAOA,CATA;;EAUAC,sBAVA;EAWAC;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MACA;QACAC;QACAC;MACA,CAHA;;MAIA;QACAC;QACAC;QACAC;MACA,CAJA;;MAKA;QACAC;QACAC;QACAC;MACA,CAJA;;MAKA;QACAC;QACAC;QACAC;MACA,CAJA;;MAKA;QACAC;QACAC;QACAC;MACA,CAJA;;MAKA;QACAC;MACA;;MACA;QACAD;MACA;;MACA;QACAH;MACA;;MACA;QACAH;MACA;;MACA;QACAH;MACA;;MACAW;QACA;;QACA;UACAD;UACA;QACA;;QACAE;UACA;UACAC;;UACA;YACAJ;;YACA;cACAC;cACA;YACA;;YACA;UACA;;UACAI;YACA;YACA;;YACA;cACAR;;cACA;gBACAG;;gBACA;kBACAC;kBACA;gBACA;;gBACA;cACA;;cACA;YACA;;YACA,IACA,uEACA,0BADA,IAEA,2BAFA,IAGA,0BAJA,EAKA;cACAD;cACA;YACA;;YACA;cACA;gBACA;kBACAM;kBAEAC;gBACA;cACA;YACA,CARA,MAQA;cACA;gBACA;kBACAD;kBACAC;gBACA;cACA;;cACA;;cACA;gBACAD;gBACAC;;gBACA;kBACAD;gBACA;cACA,CANA,MAMA;gBACA;kBACAA;gBACA,CAFA,MAEA;kBACAA;gBACA;cACA;YACA,CArBA,MAqBA;cACA;;cACA;gBACA;kBACAN;;kBACA;oBACAC;oBACA;kBACA;;kBACA;gBACA;;gBACA;cACA;YACA,CAbA,MAaA;cACA;;cACA;gBACAK;cACA,CAFA,MAEA;gBACAA;cACA;YACA,CAPA,MAOA;cACA;gBACA;kBACAA;kBACAC;gBACA;cACA;;cACA;;cACA;gBACAD;cACA,CAFA,MAEA;gBACAA;cACA;YACA;;YACAA;;YACAE;cACA;;cACA;gBACAd;;gBACA;kBACAG;;kBACA;oBACAG;;oBACA;sBACAC;sBACA;oBACA;;oBACA;kBACA;;kBACA;gBACA;;gBACA;cACA;;cACAQ;gBACA;;gBACA;kBACAlB;;kBACA;oBACAG;;oBACA;sBACAG;;sBACA;wBACAG;;wBACA;0BACAC;0BACA;wBACA;;wBACA;sBACA;;sBACA;oBACA;;oBACA;kBACA;;kBACA;gBACA;;gBACAS;kBACA;;kBACA;oBACAC;oBACAC;kBACA;;kBACA;;kBACA;oBACArB;;oBACA;sBACAG;;sBACA;wBACAG;;wBACA;0BACAG;;0BACA;4BACAC;4BACA;0BACA;;0BACA;wBACA;;wBACA;sBACA;;sBACA;oBACA;;oBACA;kBACA;gBACA;cACA;YACA;UACA;QACA;MACA;;MACA;QACA;MACA,CAFA,MAEA;QACA;;QACA;UACA;QACA;MACA;;MACA;IACA,CAlQA;;IAmQAY;MACA;QACA;MACA,CAFA,MAEA;QACA;UACA;YACA;UACA;QACA;MACA;IACA,CA7QA;;IA8QAC;MACA;;MACA;QACA;UACA;QACA,CAFA,MAEA;UACA;QACA,CAFA,MAEA;UACA;QACA;MACA;IACA,CAzRA;;IA0RAC;MACA;;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA,CAFA,MAEA;QACA;MACA;IACA,CAnSA;;IAoSAC;MACA;QACA;UACA;UACA;QACA,CAHA,MAGA;UACA;UACA;UACA;UACA;;UACA;YACA;UACA;QACA,CARA,MAQA;UACA;UACA;UACA;;UACA;YACA;UACA;QACA,CAPA,MAOA;UACA;UACA;QACA;MACA;IACA,CA7TA;;IA8TAC;MACA;MACA;MACA;;MACA;QACA;QACA;MACA,CAHA,MAGA;QACA;QACA;MACA,CAHA,MAGA;QACA;QACA;QACA;MACA,CAJA,MAIA;QACA;QACA;QACA;MACA,CAJA,MAIA;QACA;QACA;MACA,CAHA,MAGA;QACA;MACA;IACA,CAtVA;;IAuVAC;MACA;;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA,CAFA,MAEA;QACA;MACA;IACA,CAhWA;;IAiWAC;MACA;;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA,CAFA,MAEA;QACA;MACA;IACA,CA1WA;;IA2WAC;MACA;;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA,CAFA,MAEA;QACA;MACA;IACA,CApXA;;IAqXAC;MACA;;MACA;QACAC;MACA;;MACA;IACA,CA3XA;;IA4XAC;MACA;MACA;;MACA;QACAD;MACA;;MACAA;MACA;IACA,CApYA;;IAqYAE;MACA;MACA;MACA;MACA;;MACA;QACAF;QACAG;MACA;;MACA;IACA,CA/YA;;IAgZAC;MACA;MACA;MACA;MACA;;MACA;QACAC;MACA;;MACA;QACA;;QACA;UACAC;QACA;;QACAN;MACA;;MACAA;MACA;IACA,CAjaA;;IAkaAO;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA;IACA,CAxaA;;IAyaAC;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MACA;QACA,OACAC,IACA,GADA,IAEAC,oBAFA,IAGA,GAHA,IAIAC,oBAJA,IAKA,GALA,IAMAC,oBANA,IAOA,GAPA,IAQAC,oBARA,IASA,GATA,IAUAC,oBAVA,CADA;MAaA,CAdA,MAcA;QACA;MACA;IACA,CAncA;;IAocAC;MACA;MACA;MACA;IACA;;EAxcA,CAXA;EAqdAC;IACAC;EADA,CArdA;EAwdAC,aAxdA;EAydAC;IACA;EACA;AA3dA","names":["data","dayRule","dayRuleSup","dateArr","resultList","isShow","name","methods","expressionChange","sIdx","nSecond","mIdx","nMin","resetSecond","hIdx","nHour","resetMin","DIdx","nDay","resetHour","MIdx","nMonth","resetDay","resetMonth","goYear","goMonth","MM","goDay","DD","thisDD","goHour","goMin","goSecond","resultArr","nums","getIndex","getYearArr","getMonthArr","getWeekArr","getDayArr","getHourArr","getMinArr","getSecondArr","getOrderArr","arr","getAssignArr","getAverageArr","min","getCycleArr","max","add","compare","formatDate","Y","M","D","h","m","s","checkDate","watch","ex","props","mounted"],"sourceRoot":"src/components/Crontab","sources":["result.vue"],"sourcesContent":["<template>\n  <div class=\"popup-result\">\n    <p>最近5次运行时间</p>\n    <ul class=\"popup-result-scroll\">\n      <template v-if=\"isShow\">\n        <li v-for=\"item in resultList\" :key=\"item\">{{ item }}</li>\n      </template>\n      <li v-else>计算结果中...</li>\n    </ul>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      dayRule: '',\n      dayRuleSup: '',\n      dateArr: [],\n      resultList: [],\n      isShow: false\n    }\n  },\n  name: 'crontab-result',\n  methods: {\n    expressionChange() {\n      this.isShow = false\n      let ruleArr = this.$options.propsData.ex.split(' ')\n      let nums = 0\n      let resultArr = []\n      let nTime = new Date()\n      let nYear = nTime.getFullYear()\n      let nMonth = nTime.getMonth() + 1\n      let nDay = nTime.getDate()\n      let nHour = nTime.getHours()\n      let nMin = nTime.getMinutes()\n      let nSecond = nTime.getSeconds()\n      this.getSecondArr(ruleArr[0])\n      this.getMinArr(ruleArr[1])\n      this.getHourArr(ruleArr[2])\n      this.getDayArr(ruleArr[3])\n      this.getMonthArr(ruleArr[4])\n      this.getWeekArr(ruleArr[5])\n      this.getYearArr(ruleArr[6], nYear)\n      let sDate = this.dateArr[0]\n      let mDate = this.dateArr[1]\n      let hDate = this.dateArr[2]\n      let DDate = this.dateArr[3]\n      let MDate = this.dateArr[4]\n      let YDate = this.dateArr[5]\n      let sIdx = this.getIndex(sDate, nSecond)\n      let mIdx = this.getIndex(mDate, nMin)\n      let hIdx = this.getIndex(hDate, nHour)\n      let DIdx = this.getIndex(DDate, nDay)\n      let MIdx = this.getIndex(MDate, nMonth)\n      let YIdx = this.getIndex(YDate, nYear)\n      const resetSecond = function () {\n        sIdx = 0\n        nSecond = sDate[sIdx]\n      }\n      const resetMin = function () {\n        mIdx = 0\n        nMin = mDate[mIdx]\n        resetSecond()\n      }\n      const resetHour = function () {\n        hIdx = 0\n        nHour = hDate[hIdx]\n        resetMin()\n      }\n      const resetDay = function () {\n        DIdx = 0\n        nDay = DDate[DIdx]\n        resetHour()\n      }\n      const resetMonth = function () {\n        MIdx = 0\n        nMonth = MDate[MIdx]\n        resetDay()\n      }\n      if (nYear !== YDate[YIdx]) {\n        resetMonth()\n      }\n      if (nMonth !== MDate[MIdx]) {\n        resetDay()\n      }\n      if (nDay !== DDate[DIdx]) {\n        resetHour()\n      }\n      if (nHour !== hDate[hIdx]) {\n        resetMin()\n      }\n      if (nMin !== mDate[mIdx]) {\n        resetSecond()\n      }\n      goYear: for (let Yi = YIdx; Yi < YDate.length; Yi++) {\n        let YY = YDate[Yi]\n        if (nMonth > MDate[MDate.length - 1]) {\n          resetMonth()\n          continue\n        }\n        goMonth: for (let Mi = MIdx; Mi < MDate.length; Mi++) {\n          let MM = MDate[Mi]\n          MM = MM < 10 ? '0' + MM : MM\n          if (nDay > DDate[DDate.length - 1]) {\n            resetDay()\n            if (Mi == MDate.length - 1) {\n              resetMonth()\n              continue goYear\n            }\n            continue\n          }\n          goDay: for (let Di = DIdx; Di < DDate.length; Di++) {\n            let DD = DDate[Di]\n            let thisDD = DD < 10 ? '0' + DD : DD\n            if (nHour > hDate[hDate.length - 1]) {\n              resetHour()\n              if (Di == DDate.length - 1) {\n                resetDay()\n                if (Mi == MDate.length - 1) {\n                  resetMonth()\n                  continue goYear\n                }\n                continue goMonth\n              }\n              continue\n            }\n            if (\n              this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true &&\n              this.dayRule !== 'workDay' &&\n              this.dayRule !== 'lastWeek' &&\n              this.dayRule !== 'lastDay'\n            ) {\n              resetDay()\n              continue goMonth\n            }\n            if (this.dayRule == 'lastDay') {\n              if (this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                while (DD > 0 && this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                  DD--\n\n                  thisDD = DD < 10 ? '0' + DD : DD\n                }\n              }\n            } else if (this.dayRule == 'workDay') {\n              if (this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                while (DD > 0 && this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                  DD--\n                  thisDD = DD < 10 ? '0' + DD : DD\n                }\n              }\n              let thisWeek = this.formatDate(new Date(YY + '-' + MM + '-' + thisDD + ' 00:00:00'), 'week')\n              if (thisWeek == 1) {\n                DD++\n                thisDD = DD < 10 ? '0' + DD : DD\n                if (this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                  DD -= 3\n                }\n              } else if (thisWeek == 7) {\n                if (this.dayRuleSup !== 1) {\n                  DD--\n                } else {\n                  DD += 2\n                }\n              }\n            } else if (this.dayRule == 'weekDay') {\n              let thisWeek = this.formatDate(new Date(YY + '-' + MM + '-' + DD + ' 00:00:00'), 'week')\n              if (this.dayRuleSup.indexOf(thisWeek) < 0) {\n                if (Di == DDate.length - 1) {\n                  resetDay()\n                  if (Mi == MDate.length - 1) {\n                    resetMonth()\n                    continue goYear\n                  }\n                  continue goMonth\n                }\n                continue\n              }\n            } else if (this.dayRule == 'assWeek') {\n              let thisWeek = this.formatDate(new Date(YY + '-' + MM + '-' + DD + ' 00:00:00'), 'week')\n              if (this.dayRuleSup[1] >= thisWeek) {\n                DD = (this.dayRuleSup[0] - 1) * 7 + this.dayRuleSup[1] - thisWeek + 1\n              } else {\n                DD = this.dayRuleSup[0] * 7 + this.dayRuleSup[1] - thisWeek + 1\n              }\n            } else if (this.dayRule == 'lastWeek') {\n              if (this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                while (DD > 0 && this.checkDate(YY + '-' + MM + '-' + thisDD + ' 00:00:00') !== true) {\n                  DD--\n                  thisDD = DD < 10 ? '0' + DD : DD\n                }\n              }\n              let thisWeek = this.formatDate(new Date(YY + '-' + MM + '-' + thisDD + ' 00:00:00'), 'week')\n              if (this.dayRuleSup < thisWeek) {\n                DD -= thisWeek - this.dayRuleSup\n              } else if (this.dayRuleSup > thisWeek) {\n                DD -= 7 - (this.dayRuleSup - thisWeek)\n              }\n            }\n            DD = DD < 10 ? '0' + DD : DD\n            goHour: for (let hi = hIdx; hi < hDate.length; hi++) {\n              let hh = hDate[hi] < 10 ? '0' + hDate[hi] : hDate[hi]\n              if (nMin > mDate[mDate.length - 1]) {\n                resetMin()\n                if (hi == hDate.length - 1) {\n                  resetHour()\n                  if (Di == DDate.length - 1) {\n                    resetDay()\n                    if (Mi == MDate.length - 1) {\n                      resetMonth()\n                      continue goYear\n                    }\n                    continue goMonth\n                  }\n                  continue goDay\n                }\n                continue\n              }\n              goMin: for (let mi = mIdx; mi < mDate.length; mi++) {\n                let mm = mDate[mi] < 10 ? '0' + mDate[mi] : mDate[mi]\n                if (nSecond > sDate[sDate.length - 1]) {\n                  resetSecond()\n                  if (mi == mDate.length - 1) {\n                    resetMin()\n                    if (hi == hDate.length - 1) {\n                      resetHour()\n                      if (Di == DDate.length - 1) {\n                        resetDay()\n                        if (Mi == MDate.length - 1) {\n                          resetMonth()\n                          continue goYear\n                        }\n                        continue goMonth\n                      }\n                      continue goDay\n                    }\n                    continue goHour\n                  }\n                  continue\n                }\n                goSecond: for (let si = sIdx; si <= sDate.length - 1; si++) {\n                  let ss = sDate[si] < 10 ? '0' + sDate[si] : sDate[si]\n                  if (MM !== '00' && DD !== '00') {\n                    resultArr.push(YY + '-' + MM + '-' + DD + ' ' + hh + ':' + mm + ':' + ss)\n                    nums++\n                  }\n                  if (nums == 5) break goYear\n                  if (si == sDate.length - 1) {\n                    resetSecond()\n                    if (mi == mDate.length - 1) {\n                      resetMin()\n                      if (hi == hDate.length - 1) {\n                        resetHour()\n                        if (Di == DDate.length - 1) {\n                          resetDay()\n                          if (Mi == MDate.length - 1) {\n                            resetMonth()\n                            continue goYear\n                          }\n                          continue goMonth\n                        }\n                        continue goDay\n                      }\n                      continue goHour\n                    }\n                    continue goMin\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n      if (resultArr.length == 0) {\n        this.resultList = ['没有达到条件的结果！']\n      } else {\n        this.resultList = resultArr\n        if (resultArr.length !== 5) {\n          this.resultList.push('最近100年内只有上面' + resultArr.length + '条结果！')\n        }\n      }\n      this.isShow = true\n    },\n    getIndex(arr, value) {\n      if (value <= arr[0] || value > arr[arr.length - 1]) {\n        return 0\n      } else {\n        for (let i = 0; i < arr.length - 1; i++) {\n          if (value > arr[i] && value <= arr[i + 1]) {\n            return i + 1\n          }\n        }\n      }\n    },\n    getYearArr(rule, year) {\n      this.dateArr[5] = this.getOrderArr(year, year + 100)\n      if (rule !== undefined) {\n        if (rule.indexOf('-') >= 0) {\n          this.dateArr[5] = this.getCycleArr(rule, year + 100, false)\n        } else if (rule.indexOf('/') >= 0) {\n          this.dateArr[5] = this.getAverageArr(rule, year + 100)\n        } else if (rule !== '*') {\n          this.dateArr[5] = this.getAssignArr(rule)\n        }\n      }\n    },\n    getMonthArr(rule) {\n      this.dateArr[4] = this.getOrderArr(1, 12)\n      if (rule.indexOf('-') >= 0) {\n        this.dateArr[4] = this.getCycleArr(rule, 12, false)\n      } else if (rule.indexOf('/') >= 0) {\n        this.dateArr[4] = this.getAverageArr(rule, 12)\n      } else if (rule !== '*') {\n        this.dateArr[4] = this.getAssignArr(rule)\n      }\n    },\n    getWeekArr(rule) {\n      if (this.dayRule == '' && this.dayRuleSup == '') {\n        if (rule.indexOf('-') >= 0) {\n          this.dayRule = 'weekDay'\n          this.dayRuleSup = this.getCycleArr(rule, 7, false)\n        } else if (rule.indexOf('#') >= 0) {\n          this.dayRule = 'assWeek'\n          let matchRule = rule.match(/[0-9]{1}/g)\n          this.dayRuleSup = [Number(matchRule[1]), Number(matchRule[0])]\n          this.dateArr[3] = [1]\n          if (this.dayRuleSup[1] == 7) {\n            this.dayRuleSup[1] = 0\n          }\n        } else if (rule.indexOf('L') >= 0) {\n          this.dayRule = 'lastWeek'\n          this.dayRuleSup = Number(rule.match(/[0-9]{1,2}/g)[0])\n          this.dateArr[3] = [31]\n          if (this.dayRuleSup == 7) {\n            this.dayRuleSup = 0\n          }\n        } else if (rule !== '*' && rule !== '?') {\n          this.dayRule = 'weekDay'\n          this.dayRuleSup = this.getAssignArr(rule)\n        }\n      }\n    },\n    getDayArr(rule) {\n      this.dateArr[3] = this.getOrderArr(1, 31)\n      this.dayRule = ''\n      this.dayRuleSup = ''\n      if (rule.indexOf('-') >= 0) {\n        this.dateArr[3] = this.getCycleArr(rule, 31, false)\n        this.dayRuleSup = 'null'\n      } else if (rule.indexOf('/') >= 0) {\n        this.dateArr[3] = this.getAverageArr(rule, 31)\n        this.dayRuleSup = 'null'\n      } else if (rule.indexOf('W') >= 0) {\n        this.dayRule = 'workDay'\n        this.dayRuleSup = Number(rule.match(/[0-9]{1,2}/g)[0])\n        this.dateArr[3] = [this.dayRuleSup]\n      } else if (rule.indexOf('L') >= 0) {\n        this.dayRule = 'lastDay'\n        this.dayRuleSup = 'null'\n        this.dateArr[3] = [31]\n      } else if (rule !== '*' && rule !== '?') {\n        this.dateArr[3] = this.getAssignArr(rule)\n        this.dayRuleSup = 'null'\n      } else if (rule == '*') {\n        this.dayRuleSup = 'null'\n      }\n    },\n    getHourArr(rule) {\n      this.dateArr[2] = this.getOrderArr(0, 23)\n      if (rule.indexOf('-') >= 0) {\n        this.dateArr[2] = this.getCycleArr(rule, 24, true)\n      } else if (rule.indexOf('/') >= 0) {\n        this.dateArr[2] = this.getAverageArr(rule, 23)\n      } else if (rule !== '*') {\n        this.dateArr[2] = this.getAssignArr(rule)\n      }\n    },\n    getMinArr(rule) {\n      this.dateArr[1] = this.getOrderArr(0, 59)\n      if (rule.indexOf('-') >= 0) {\n        this.dateArr[1] = this.getCycleArr(rule, 60, true)\n      } else if (rule.indexOf('/') >= 0) {\n        this.dateArr[1] = this.getAverageArr(rule, 59)\n      } else if (rule !== '*') {\n        this.dateArr[1] = this.getAssignArr(rule)\n      }\n    },\n    getSecondArr(rule) {\n      this.dateArr[0] = this.getOrderArr(0, 59)\n      if (rule.indexOf('-') >= 0) {\n        this.dateArr[0] = this.getCycleArr(rule, 60, true)\n      } else if (rule.indexOf('/') >= 0) {\n        this.dateArr[0] = this.getAverageArr(rule, 59)\n      } else if (rule !== '*') {\n        this.dateArr[0] = this.getAssignArr(rule)\n      }\n    },\n    getOrderArr(min, max) {\n      let arr = []\n      for (let i = min; i <= max; i++) {\n        arr.push(i)\n      }\n      return arr\n    },\n    getAssignArr(rule) {\n      let arr = []\n      let assiginArr = rule.split(',')\n      for (let i = 0; i < assiginArr.length; i++) {\n        arr[i] = Number(assiginArr[i])\n      }\n      arr.sort(this.compare)\n      return arr\n    },\n    getAverageArr(rule, limit) {\n      let arr = []\n      let agArr = rule.split('/')\n      let min = Number(agArr[0])\n      let step = Number(agArr[1])\n      while (min <= limit) {\n        arr.push(min)\n        min += step\n      }\n      return arr\n    },\n    getCycleArr(rule, limit, status) {\n      let arr = []\n      let cycleArr = rule.split('-')\n      let min = Number(cycleArr[0])\n      let max = Number(cycleArr[1])\n      if (min > max) {\n        max += limit\n      }\n      for (let i = min; i <= max; i++) {\n        let add = 0\n        if (status == false && i % limit == 0) {\n          add = limit\n        }\n        arr.push(Math.round((i % limit) + add))\n      }\n      arr.sort(this.compare)\n      return arr\n    },\n    compare(value1, value2) {\n      if (value2 - value1 > 0) {\n        return -1\n      } else {\n        return 1\n      }\n    },\n    formatDate(value, type) {\n      let time = typeof value == 'number' ? new Date(value) : value\n      let Y = time.getFullYear()\n      let M = time.getMonth() + 1\n      let D = time.getDate()\n      let h = time.getHours()\n      let m = time.getMinutes()\n      let s = time.getSeconds()\n      let week = time.getDay()\n      if (type == undefined) {\n        return (\n          Y +\n          '-' +\n          (M < 10 ? '0' + M : M) +\n          '-' +\n          (D < 10 ? '0' + D : D) +\n          ' ' +\n          (h < 10 ? '0' + h : h) +\n          ':' +\n          (m < 10 ? '0' + m : m) +\n          ':' +\n          (s < 10 ? '0' + s : s)\n        )\n      } else if (type == 'week') {\n        return week + 1\n      }\n    },\n    checkDate(value) {\n      let time = new Date(value)\n      let format = this.formatDate(time)\n      return value === format\n    }\n  },\n  watch: {\n    ex: 'expressionChange'\n  },\n  props: ['ex'],\n  mounted: function () {\n    this.expressionChange()\n  }\n}\n</script>\n"]},"metadata":{},"sourceType":"module"}