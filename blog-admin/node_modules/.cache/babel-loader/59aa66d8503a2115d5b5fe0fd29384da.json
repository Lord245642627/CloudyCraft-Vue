{"ast":null,"code":"var easingFuncs = require(\"./easing\");\n/**\n * 动画主控制器\n * @config target 动画对象，可以是数组，如果是数组的话会批量分发onframe等事件\n * @config life(1000) 动画时长\n * @config delay(0) 动画延迟时间\n * @config loop(true)\n * @config gap(0) 循环的间隔时间\n * @config onframe\n * @config easing(optional)\n * @config ondestroy(optional)\n * @config onrestart(optional)\n *\n * TODO pause\n */\n\n\nfunction Clip(options) {\n  this._target = options.target; // 生命周期\n\n  this._life = options.life || 1000; // 延时\n\n  this._delay = options.delay || 0; // 开始时间\n  // this._startTime = new Date().getTime() + this._delay;// 单位毫秒\n\n  this._initialized = false; // 是否循环\n\n  this.loop = options.loop == null ? false : options.loop;\n  this.gap = options.gap || 0;\n  this.easing = options.easing || 'Linear';\n  this.onframe = options.onframe;\n  this.ondestroy = options.ondestroy;\n  this.onrestart = options.onrestart;\n  this._pausedTime = 0;\n  this._paused = false;\n}\n\nClip.prototype = {\n  constructor: Clip,\n  step: function (globalTime, deltaTime) {\n    // Set startTime on first step, or _startTime may has milleseconds different between clips\n    // PENDING\n    if (!this._initialized) {\n      this._startTime = globalTime + this._delay;\n      this._initialized = true;\n    }\n\n    if (this._paused) {\n      this._pausedTime += deltaTime;\n      return;\n    }\n\n    var percent = (globalTime - this._startTime - this._pausedTime) / this._life; // 还没开始\n\n    if (percent < 0) {\n      return;\n    }\n\n    percent = Math.min(percent, 1);\n    var easing = this.easing;\n    var easingFunc = typeof easing === 'string' ? easingFuncs[easing] : easing;\n    var schedule = typeof easingFunc === 'function' ? easingFunc(percent) : percent;\n    this.fire('frame', schedule); // 结束\n\n    if (percent === 1) {\n      if (this.loop) {\n        this.restart(globalTime); // 重新开始周期\n        // 抛出而不是直接调用事件直到 stage.update 后再统一调用这些事件\n\n        return 'restart';\n      } // 动画完成将这个控制器标识为待删除\n      // 在Animation.update中进行批量删除\n\n\n      this._needsRemove = true;\n      return 'destroy';\n    }\n\n    return null;\n  },\n  restart: function (globalTime) {\n    var remainder = (globalTime - this._startTime - this._pausedTime) % this._life;\n    this._startTime = globalTime - remainder + this.gap;\n    this._pausedTime = 0;\n    this._needsRemove = false;\n  },\n  fire: function (eventType, arg) {\n    eventType = 'on' + eventType;\n\n    if (this[eventType]) {\n      this[eventType](this._target, arg);\n    }\n  },\n  pause: function () {\n    this._paused = true;\n  },\n  resume: function () {\n    this._paused = false;\n  }\n};\nvar _default = Clip;\nmodule.exports = _default;","map":{"version":3,"names":["easingFuncs","require","Clip","options","_target","target","_life","life","_delay","delay","_initialized","loop","gap","easing","onframe","ondestroy","onrestart","_pausedTime","_paused","prototype","constructor","step","globalTime","deltaTime","_startTime","percent","Math","min","easingFunc","schedule","fire","restart","_needsRemove","remainder","eventType","arg","pause","resume","_default","module","exports"],"sources":["/Users/lord/Documents/Programmer/vue/VueProjects/blog-vue/blog-admin/node_modules/zrender/lib/animation/Clip.js"],"sourcesContent":["var easingFuncs = require(\"./easing\");\n\n/**\n * 动画主控制器\n * @config target 动画对象，可以是数组，如果是数组的话会批量分发onframe等事件\n * @config life(1000) 动画时长\n * @config delay(0) 动画延迟时间\n * @config loop(true)\n * @config gap(0) 循环的间隔时间\n * @config onframe\n * @config easing(optional)\n * @config ondestroy(optional)\n * @config onrestart(optional)\n *\n * TODO pause\n */\nfunction Clip(options) {\n  this._target = options.target; // 生命周期\n\n  this._life = options.life || 1000; // 延时\n\n  this._delay = options.delay || 0; // 开始时间\n  // this._startTime = new Date().getTime() + this._delay;// 单位毫秒\n\n  this._initialized = false; // 是否循环\n\n  this.loop = options.loop == null ? false : options.loop;\n  this.gap = options.gap || 0;\n  this.easing = options.easing || 'Linear';\n  this.onframe = options.onframe;\n  this.ondestroy = options.ondestroy;\n  this.onrestart = options.onrestart;\n  this._pausedTime = 0;\n  this._paused = false;\n}\n\nClip.prototype = {\n  constructor: Clip,\n  step: function (globalTime, deltaTime) {\n    // Set startTime on first step, or _startTime may has milleseconds different between clips\n    // PENDING\n    if (!this._initialized) {\n      this._startTime = globalTime + this._delay;\n      this._initialized = true;\n    }\n\n    if (this._paused) {\n      this._pausedTime += deltaTime;\n      return;\n    }\n\n    var percent = (globalTime - this._startTime - this._pausedTime) / this._life; // 还没开始\n\n    if (percent < 0) {\n      return;\n    }\n\n    percent = Math.min(percent, 1);\n    var easing = this.easing;\n    var easingFunc = typeof easing === 'string' ? easingFuncs[easing] : easing;\n    var schedule = typeof easingFunc === 'function' ? easingFunc(percent) : percent;\n    this.fire('frame', schedule); // 结束\n\n    if (percent === 1) {\n      if (this.loop) {\n        this.restart(globalTime); // 重新开始周期\n        // 抛出而不是直接调用事件直到 stage.update 后再统一调用这些事件\n\n        return 'restart';\n      } // 动画完成将这个控制器标识为待删除\n      // 在Animation.update中进行批量删除\n\n\n      this._needsRemove = true;\n      return 'destroy';\n    }\n\n    return null;\n  },\n  restart: function (globalTime) {\n    var remainder = (globalTime - this._startTime - this._pausedTime) % this._life;\n    this._startTime = globalTime - remainder + this.gap;\n    this._pausedTime = 0;\n    this._needsRemove = false;\n  },\n  fire: function (eventType, arg) {\n    eventType = 'on' + eventType;\n\n    if (this[eventType]) {\n      this[eventType](this._target, arg);\n    }\n  },\n  pause: function () {\n    this._paused = true;\n  },\n  resume: function () {\n    this._paused = false;\n  }\n};\nvar _default = Clip;\nmodule.exports = _default;"],"mappings":"AAAA,IAAIA,WAAW,GAAGC,OAAO,CAAC,UAAD,CAAzB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASC,IAAT,CAAcC,OAAd,EAAuB;EACrB,KAAKC,OAAL,GAAeD,OAAO,CAACE,MAAvB,CADqB,CACU;;EAE/B,KAAKC,KAAL,GAAaH,OAAO,CAACI,IAAR,IAAgB,IAA7B,CAHqB,CAGc;;EAEnC,KAAKC,MAAL,GAAcL,OAAO,CAACM,KAAR,IAAiB,CAA/B,CALqB,CAKa;EAClC;;EAEA,KAAKC,YAAL,GAAoB,KAApB,CARqB,CAQM;;EAE3B,KAAKC,IAAL,GAAYR,OAAO,CAACQ,IAAR,IAAgB,IAAhB,GAAuB,KAAvB,GAA+BR,OAAO,CAACQ,IAAnD;EACA,KAAKC,GAAL,GAAWT,OAAO,CAACS,GAAR,IAAe,CAA1B;EACA,KAAKC,MAAL,GAAcV,OAAO,CAACU,MAAR,IAAkB,QAAhC;EACA,KAAKC,OAAL,GAAeX,OAAO,CAACW,OAAvB;EACA,KAAKC,SAAL,GAAiBZ,OAAO,CAACY,SAAzB;EACA,KAAKC,SAAL,GAAiBb,OAAO,CAACa,SAAzB;EACA,KAAKC,WAAL,GAAmB,CAAnB;EACA,KAAKC,OAAL,GAAe,KAAf;AACD;;AAEDhB,IAAI,CAACiB,SAAL,GAAiB;EACfC,WAAW,EAAElB,IADE;EAEfmB,IAAI,EAAE,UAAUC,UAAV,EAAsBC,SAAtB,EAAiC;IACrC;IACA;IACA,IAAI,CAAC,KAAKb,YAAV,EAAwB;MACtB,KAAKc,UAAL,GAAkBF,UAAU,GAAG,KAAKd,MAApC;MACA,KAAKE,YAAL,GAAoB,IAApB;IACD;;IAED,IAAI,KAAKQ,OAAT,EAAkB;MAChB,KAAKD,WAAL,IAAoBM,SAApB;MACA;IACD;;IAED,IAAIE,OAAO,GAAG,CAACH,UAAU,GAAG,KAAKE,UAAlB,GAA+B,KAAKP,WAArC,IAAoD,KAAKX,KAAvE,CAbqC,CAayC;;IAE9E,IAAImB,OAAO,GAAG,CAAd,EAAiB;MACf;IACD;;IAEDA,OAAO,GAAGC,IAAI,CAACC,GAAL,CAASF,OAAT,EAAkB,CAAlB,CAAV;IACA,IAAIZ,MAAM,GAAG,KAAKA,MAAlB;IACA,IAAIe,UAAU,GAAG,OAAOf,MAAP,KAAkB,QAAlB,GAA6Bb,WAAW,CAACa,MAAD,CAAxC,GAAmDA,MAApE;IACA,IAAIgB,QAAQ,GAAG,OAAOD,UAAP,KAAsB,UAAtB,GAAmCA,UAAU,CAACH,OAAD,CAA7C,GAAyDA,OAAxE;IACA,KAAKK,IAAL,CAAU,OAAV,EAAmBD,QAAnB,EAvBqC,CAuBP;;IAE9B,IAAIJ,OAAO,KAAK,CAAhB,EAAmB;MACjB,IAAI,KAAKd,IAAT,EAAe;QACb,KAAKoB,OAAL,CAAaT,UAAb,EADa,CACa;QAC1B;;QAEA,OAAO,SAAP;MACD,CANgB,CAMf;MACF;;;MAGA,KAAKU,YAAL,GAAoB,IAApB;MACA,OAAO,SAAP;IACD;;IAED,OAAO,IAAP;EACD,CA1Cc;EA2CfD,OAAO,EAAE,UAAUT,UAAV,EAAsB;IAC7B,IAAIW,SAAS,GAAG,CAACX,UAAU,GAAG,KAAKE,UAAlB,GAA+B,KAAKP,WAArC,IAAoD,KAAKX,KAAzE;IACA,KAAKkB,UAAL,GAAkBF,UAAU,GAAGW,SAAb,GAAyB,KAAKrB,GAAhD;IACA,KAAKK,WAAL,GAAmB,CAAnB;IACA,KAAKe,YAAL,GAAoB,KAApB;EACD,CAhDc;EAiDfF,IAAI,EAAE,UAAUI,SAAV,EAAqBC,GAArB,EAA0B;IAC9BD,SAAS,GAAG,OAAOA,SAAnB;;IAEA,IAAI,KAAKA,SAAL,CAAJ,EAAqB;MACnB,KAAKA,SAAL,EAAgB,KAAK9B,OAArB,EAA8B+B,GAA9B;IACD;EACF,CAvDc;EAwDfC,KAAK,EAAE,YAAY;IACjB,KAAKlB,OAAL,GAAe,IAAf;EACD,CA1Dc;EA2DfmB,MAAM,EAAE,YAAY;IAClB,KAAKnB,OAAL,GAAe,KAAf;EACD;AA7Dc,CAAjB;AA+DA,IAAIoB,QAAQ,GAAGpC,IAAf;AACAqC,MAAM,CAACC,OAAP,GAAiBF,QAAjB"},"metadata":{},"sourceType":"script"}