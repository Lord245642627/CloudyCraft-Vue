{"ast":null,"code":"import * as d3 from 'd3';\nimport * as _ from 'lodash-es';\nimport { addLabel } from './label/add-label.js';\nimport * as util from './util.js';\nexport { createNodes, setCreateNodes };\n\nvar createNodes = function (selection, g, shapes) {\n  var simpleNodes = g.nodes().filter(function (v) {\n    return !util.isSubgraph(g, v);\n  });\n  var svgNodes = selection.selectAll('g.node').data(simpleNodes, function (v) {\n    return v;\n  }).classed('update', true);\n  svgNodes.exit().remove();\n  svgNodes.enter().append('g').attr('class', 'node').style('opacity', 0);\n  svgNodes = selection.selectAll('g.node');\n  svgNodes.each(function (v) {\n    var node = g.node(v);\n    var thisGroup = d3.select(this);\n    util.applyClass(thisGroup, node['class'], (thisGroup.classed('update') ? 'update ' : '') + 'node');\n    thisGroup.select('g.label').remove();\n    var labelGroup = thisGroup.append('g').attr('class', 'label');\n    var labelDom = addLabel(labelGroup, node);\n    var shape = shapes[node.shape];\n\n    var bbox = _.pick(labelDom.node().getBBox(), 'width', 'height');\n\n    node.elem = this;\n\n    if (node.id) {\n      thisGroup.attr('id', node.id);\n    }\n\n    if (node.labelId) {\n      labelGroup.attr('id', node.labelId);\n    }\n\n    if (_.has(node, 'width')) {\n      bbox.width = node.width;\n    }\n\n    if (_.has(node, 'height')) {\n      bbox.height = node.height;\n    }\n\n    bbox.width += node.paddingLeft + node.paddingRight;\n    bbox.height += node.paddingTop + node.paddingBottom;\n    labelGroup.attr('transform', 'translate(' + (node.paddingLeft - node.paddingRight) / 2 + ',' + (node.paddingTop - node.paddingBottom) / 2 + ')');\n    var root = d3.select(this);\n    root.select('.label-container').remove();\n    var shapeSvg = shape(root, bbox, node).classed('label-container', true);\n    util.applyStyle(shapeSvg, node.style);\n    var shapeBBox = shapeSvg.node().getBBox();\n    node.width = shapeBBox.width;\n    node.height = shapeBBox.height;\n  });\n  var exitSelection;\n\n  if (svgNodes.exit) {\n    exitSelection = svgNodes.exit();\n  } else {\n    exitSelection = svgNodes.selectAll(null); // empty selection\n  }\n\n  util.applyTransition(exitSelection, g).style('opacity', 0).remove();\n  return svgNodes;\n};\n\nfunction setCreateNodes(value) {\n  createNodes = value;\n}","map":{"version":3,"names":["d3","_","addLabel","util","createNodes","setCreateNodes","selection","g","shapes","simpleNodes","nodes","filter","v","isSubgraph","svgNodes","selectAll","data","classed","exit","remove","enter","append","attr","style","each","node","thisGroup","select","applyClass","labelGroup","labelDom","shape","bbox","pick","getBBox","elem","id","labelId","has","width","height","paddingLeft","paddingRight","paddingTop","paddingBottom","root","shapeSvg","applyStyle","shapeBBox","exitSelection","applyTransition","value"],"sources":["/Users/lord/Documents/Programmer/vue/VueProjects/cloudycraft-vue/blog-web/node_modules/dagre-d3-es/src/dagre-js/create-nodes.js"],"sourcesContent":["import * as d3 from 'd3';\nimport * as _ from 'lodash-es';\nimport { addLabel } from './label/add-label.js';\nimport * as util from './util.js';\n\nexport { createNodes, setCreateNodes };\n\nvar createNodes = function (selection, g, shapes) {\n  var simpleNodes = g.nodes().filter(function (v) {\n    return !util.isSubgraph(g, v);\n  });\n  var svgNodes = selection\n    .selectAll('g.node')\n    .data(simpleNodes, function (v) {\n      return v;\n    })\n    .classed('update', true);\n\n  svgNodes.exit().remove();\n\n  svgNodes.enter().append('g').attr('class', 'node').style('opacity', 0);\n\n  svgNodes = selection.selectAll('g.node');\n\n  svgNodes.each(function (v) {\n    var node = g.node(v);\n    var thisGroup = d3.select(this);\n    util.applyClass(\n      thisGroup,\n      node['class'],\n      (thisGroup.classed('update') ? 'update ' : '') + 'node'\n    );\n\n    thisGroup.select('g.label').remove();\n    var labelGroup = thisGroup.append('g').attr('class', 'label');\n    var labelDom = addLabel(labelGroup, node);\n    var shape = shapes[node.shape];\n    var bbox = _.pick(labelDom.node().getBBox(), 'width', 'height');\n\n    node.elem = this;\n\n    if (node.id) {\n      thisGroup.attr('id', node.id);\n    }\n    if (node.labelId) {\n      labelGroup.attr('id', node.labelId);\n    }\n\n    if (_.has(node, 'width')) {\n      bbox.width = node.width;\n    }\n    if (_.has(node, 'height')) {\n      bbox.height = node.height;\n    }\n\n    bbox.width += node.paddingLeft + node.paddingRight;\n    bbox.height += node.paddingTop + node.paddingBottom;\n    labelGroup.attr(\n      'transform',\n      'translate(' +\n        (node.paddingLeft - node.paddingRight) / 2 +\n        ',' +\n        (node.paddingTop - node.paddingBottom) / 2 +\n        ')'\n    );\n\n    var root = d3.select(this);\n    root.select('.label-container').remove();\n    var shapeSvg = shape(root, bbox, node).classed('label-container', true);\n    util.applyStyle(shapeSvg, node.style);\n\n    var shapeBBox = shapeSvg.node().getBBox();\n    node.width = shapeBBox.width;\n    node.height = shapeBBox.height;\n  });\n\n  var exitSelection;\n\n  if (svgNodes.exit) {\n    exitSelection = svgNodes.exit();\n  } else {\n    exitSelection = svgNodes.selectAll(null); // empty selection\n  }\n\n  util.applyTransition(exitSelection, g).style('opacity', 0).remove();\n\n  return svgNodes;\n};\n\nfunction setCreateNodes(value) {\n  createNodes = value;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}