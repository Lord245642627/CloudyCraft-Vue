{"ast":null,"code":"import * as _ from 'lodash-es';\nimport { barycenter } from './barycenter.js';\nimport { resolveConflicts } from './resolve-conflicts.js';\nimport { sort } from './sort.js';\nexport { sortSubgraph };\n\nfunction sortSubgraph(g, v, cg, biasRight) {\n  var movable = g.children(v);\n  var node = g.node(v);\n  var bl = node ? node.borderLeft : undefined;\n  var br = node ? node.borderRight : undefined;\n  var subgraphs = {};\n\n  if (bl) {\n    movable = _.filter(movable, function (w) {\n      return w !== bl && w !== br;\n    });\n  }\n\n  var barycenters = barycenter(g, movable);\n\n  _.forEach(barycenters, function (entry) {\n    if (g.children(entry.v).length) {\n      var subgraphResult = sortSubgraph(g, entry.v, cg, biasRight);\n      subgraphs[entry.v] = subgraphResult;\n\n      if (_.has(subgraphResult, 'barycenter')) {\n        mergeBarycenters(entry, subgraphResult);\n      }\n    }\n  });\n\n  var entries = resolveConflicts(barycenters, cg);\n  expandSubgraphs(entries, subgraphs);\n  var result = sort(entries, biasRight);\n\n  if (bl) {\n    result.vs = _.flatten([bl, result.vs, br]);\n\n    if (g.predecessors(bl).length) {\n      var blPred = g.node(g.predecessors(bl)[0]),\n          brPred = g.node(g.predecessors(br)[0]);\n\n      if (!_.has(result, 'barycenter')) {\n        result.barycenter = 0;\n        result.weight = 0;\n      }\n\n      result.barycenter = (result.barycenter * result.weight + blPred.order + brPred.order) / (result.weight + 2);\n      result.weight += 2;\n    }\n  }\n\n  return result;\n}\n\nfunction expandSubgraphs(entries, subgraphs) {\n  _.forEach(entries, function (entry) {\n    entry.vs = _.flatten(entry.vs.map(function (v) {\n      if (subgraphs[v]) {\n        return subgraphs[v].vs;\n      }\n\n      return v;\n    }));\n  });\n}\n\nfunction mergeBarycenters(target, other) {\n  if (!_.isUndefined(target.barycenter)) {\n    target.barycenter = (target.barycenter * target.weight + other.barycenter * other.weight) / (target.weight + other.weight);\n    target.weight += other.weight;\n  } else {\n    target.barycenter = other.barycenter;\n    target.weight = other.weight;\n  }\n}","map":{"version":3,"names":["_","barycenter","resolveConflicts","sort","sortSubgraph","g","v","cg","biasRight","movable","children","node","bl","borderLeft","undefined","br","borderRight","subgraphs","filter","w","barycenters","forEach","entry","length","subgraphResult","has","mergeBarycenters","entries","expandSubgraphs","result","vs","flatten","predecessors","blPred","brPred","weight","order","map","target","other","isUndefined"],"sources":["/Users/lord/Documents/Programmer/vue/VueProjects/cloudycraft-vue/blog-web/node_modules/dagre-d3-es/src/dagre/order/sort-subgraph.js"],"sourcesContent":["import * as _ from 'lodash-es';\nimport { barycenter } from './barycenter.js';\nimport { resolveConflicts } from './resolve-conflicts.js';\nimport { sort } from './sort.js';\n\nexport { sortSubgraph };\n\nfunction sortSubgraph(g, v, cg, biasRight) {\n  var movable = g.children(v);\n  var node = g.node(v);\n  var bl = node ? node.borderLeft : undefined;\n  var br = node ? node.borderRight : undefined;\n  var subgraphs = {};\n\n  if (bl) {\n    movable = _.filter(movable, function (w) {\n      return w !== bl && w !== br;\n    });\n  }\n\n  var barycenters = barycenter(g, movable);\n  _.forEach(barycenters, function (entry) {\n    if (g.children(entry.v).length) {\n      var subgraphResult = sortSubgraph(g, entry.v, cg, biasRight);\n      subgraphs[entry.v] = subgraphResult;\n      if (_.has(subgraphResult, 'barycenter')) {\n        mergeBarycenters(entry, subgraphResult);\n      }\n    }\n  });\n\n  var entries = resolveConflicts(barycenters, cg);\n  expandSubgraphs(entries, subgraphs);\n\n  var result = sort(entries, biasRight);\n\n  if (bl) {\n    result.vs = _.flatten([bl, result.vs, br]);\n    if (g.predecessors(bl).length) {\n      var blPred = g.node(g.predecessors(bl)[0]),\n        brPred = g.node(g.predecessors(br)[0]);\n      if (!_.has(result, 'barycenter')) {\n        result.barycenter = 0;\n        result.weight = 0;\n      }\n      result.barycenter =\n        (result.barycenter * result.weight + blPred.order + brPred.order) / (result.weight + 2);\n      result.weight += 2;\n    }\n  }\n\n  return result;\n}\n\nfunction expandSubgraphs(entries, subgraphs) {\n  _.forEach(entries, function (entry) {\n    entry.vs = _.flatten(\n      entry.vs.map(function (v) {\n        if (subgraphs[v]) {\n          return subgraphs[v].vs;\n        }\n        return v;\n      })\n    );\n  });\n}\n\nfunction mergeBarycenters(target, other) {\n  if (!_.isUndefined(target.barycenter)) {\n    target.barycenter =\n      (target.barycenter * target.weight + other.barycenter * other.weight) /\n      (target.weight + other.weight);\n    target.weight += other.weight;\n  } else {\n    target.barycenter = other.barycenter;\n    target.weight = other.weight;\n  }\n}\n"],"mappings":"AAAA,OAAO,KAAKA,CAAZ,MAAmB,WAAnB;AACA,SAASC,UAAT,QAA2B,iBAA3B;AACA,SAASC,gBAAT,QAAiC,wBAAjC;AACA,SAASC,IAAT,QAAqB,WAArB;AAEA,SAASC,YAAT;;AAEA,SAASA,YAAT,CAAsBC,CAAtB,EAAyBC,CAAzB,EAA4BC,EAA5B,EAAgCC,SAAhC,EAA2C;EACzC,IAAIC,OAAO,GAAGJ,CAAC,CAACK,QAAF,CAAWJ,CAAX,CAAd;EACA,IAAIK,IAAI,GAAGN,CAAC,CAACM,IAAF,CAAOL,CAAP,CAAX;EACA,IAAIM,EAAE,GAAGD,IAAI,GAAGA,IAAI,CAACE,UAAR,GAAqBC,SAAlC;EACA,IAAIC,EAAE,GAAGJ,IAAI,GAAGA,IAAI,CAACK,WAAR,GAAsBF,SAAnC;EACA,IAAIG,SAAS,GAAG,EAAhB;;EAEA,IAAIL,EAAJ,EAAQ;IACNH,OAAO,GAAGT,CAAC,CAACkB,MAAF,CAAST,OAAT,EAAkB,UAAUU,CAAV,EAAa;MACvC,OAAOA,CAAC,KAAKP,EAAN,IAAYO,CAAC,KAAKJ,EAAzB;IACD,CAFS,CAAV;EAGD;;EAED,IAAIK,WAAW,GAAGnB,UAAU,CAACI,CAAD,EAAII,OAAJ,CAA5B;;EACAT,CAAC,CAACqB,OAAF,CAAUD,WAAV,EAAuB,UAAUE,KAAV,EAAiB;IACtC,IAAIjB,CAAC,CAACK,QAAF,CAAWY,KAAK,CAAChB,CAAjB,EAAoBiB,MAAxB,EAAgC;MAC9B,IAAIC,cAAc,GAAGpB,YAAY,CAACC,CAAD,EAAIiB,KAAK,CAAChB,CAAV,EAAaC,EAAb,EAAiBC,SAAjB,CAAjC;MACAS,SAAS,CAACK,KAAK,CAAChB,CAAP,CAAT,GAAqBkB,cAArB;;MACA,IAAIxB,CAAC,CAACyB,GAAF,CAAMD,cAAN,EAAsB,YAAtB,CAAJ,EAAyC;QACvCE,gBAAgB,CAACJ,KAAD,EAAQE,cAAR,CAAhB;MACD;IACF;EACF,CARD;;EAUA,IAAIG,OAAO,GAAGzB,gBAAgB,CAACkB,WAAD,EAAcb,EAAd,CAA9B;EACAqB,eAAe,CAACD,OAAD,EAAUV,SAAV,CAAf;EAEA,IAAIY,MAAM,GAAG1B,IAAI,CAACwB,OAAD,EAAUnB,SAAV,CAAjB;;EAEA,IAAII,EAAJ,EAAQ;IACNiB,MAAM,CAACC,EAAP,GAAY9B,CAAC,CAAC+B,OAAF,CAAU,CAACnB,EAAD,EAAKiB,MAAM,CAACC,EAAZ,EAAgBf,EAAhB,CAAV,CAAZ;;IACA,IAAIV,CAAC,CAAC2B,YAAF,CAAepB,EAAf,EAAmBW,MAAvB,EAA+B;MAC7B,IAAIU,MAAM,GAAG5B,CAAC,CAACM,IAAF,CAAON,CAAC,CAAC2B,YAAF,CAAepB,EAAf,EAAmB,CAAnB,CAAP,CAAb;MAAA,IACEsB,MAAM,GAAG7B,CAAC,CAACM,IAAF,CAAON,CAAC,CAAC2B,YAAF,CAAejB,EAAf,EAAmB,CAAnB,CAAP,CADX;;MAEA,IAAI,CAACf,CAAC,CAACyB,GAAF,CAAMI,MAAN,EAAc,YAAd,CAAL,EAAkC;QAChCA,MAAM,CAAC5B,UAAP,GAAoB,CAApB;QACA4B,MAAM,CAACM,MAAP,GAAgB,CAAhB;MACD;;MACDN,MAAM,CAAC5B,UAAP,GACE,CAAC4B,MAAM,CAAC5B,UAAP,GAAoB4B,MAAM,CAACM,MAA3B,GAAoCF,MAAM,CAACG,KAA3C,GAAmDF,MAAM,CAACE,KAA3D,KAAqEP,MAAM,CAACM,MAAP,GAAgB,CAArF,CADF;MAEAN,MAAM,CAACM,MAAP,IAAiB,CAAjB;IACD;EACF;;EAED,OAAON,MAAP;AACD;;AAED,SAASD,eAAT,CAAyBD,OAAzB,EAAkCV,SAAlC,EAA6C;EAC3CjB,CAAC,CAACqB,OAAF,CAAUM,OAAV,EAAmB,UAAUL,KAAV,EAAiB;IAClCA,KAAK,CAACQ,EAAN,GAAW9B,CAAC,CAAC+B,OAAF,CACTT,KAAK,CAACQ,EAAN,CAASO,GAAT,CAAa,UAAU/B,CAAV,EAAa;MACxB,IAAIW,SAAS,CAACX,CAAD,CAAb,EAAkB;QAChB,OAAOW,SAAS,CAACX,CAAD,CAAT,CAAawB,EAApB;MACD;;MACD,OAAOxB,CAAP;IACD,CALD,CADS,CAAX;EAQD,CATD;AAUD;;AAED,SAASoB,gBAAT,CAA0BY,MAA1B,EAAkCC,KAAlC,EAAyC;EACvC,IAAI,CAACvC,CAAC,CAACwC,WAAF,CAAcF,MAAM,CAACrC,UAArB,CAAL,EAAuC;IACrCqC,MAAM,CAACrC,UAAP,GACE,CAACqC,MAAM,CAACrC,UAAP,GAAoBqC,MAAM,CAACH,MAA3B,GAAoCI,KAAK,CAACtC,UAAN,GAAmBsC,KAAK,CAACJ,MAA9D,KACCG,MAAM,CAACH,MAAP,GAAgBI,KAAK,CAACJ,MADvB,CADF;IAGAG,MAAM,CAACH,MAAP,IAAiBI,KAAK,CAACJ,MAAvB;EACD,CALD,MAKO;IACLG,MAAM,CAACrC,UAAP,GAAoBsC,KAAK,CAACtC,UAA1B;IACAqC,MAAM,CAACH,MAAP,GAAgBI,KAAK,CAACJ,MAAtB;EACD;AACF"},"metadata":{},"sourceType":"module"}