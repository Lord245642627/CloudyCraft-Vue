{"ast":null,"code":"import * as d3 from 'd3';\nimport * as _ from 'lodash-es';\nimport { layout } from '../dagre/index.js';\nimport { arrows, setArrows } from './arrows.js';\nimport { createClusters, setCreateClusters } from './create-clusters.js';\nimport { createEdgeLabels, setCreateEdgeLabels } from './create-edge-labels.js';\nimport { createEdgePaths, setCreateEdgePaths } from './create-edge-paths.js';\nimport { createNodes, setCreateNodes } from './create-nodes.js';\nimport { positionClusters } from './position-clusters.js';\nimport { positionEdgeLabels } from './position-edge-labels.js';\nimport { positionNodes } from './position-nodes.js';\nimport { shapes, setShapes } from './shapes.js';\nexport { render }; // This design is based on http://bost.ocks.org/mike/chart/.\n\nfunction render() {\n  var fn = function (svg, g) {\n    preProcessGraph(g);\n    var outputGroup = createOrSelectGroup(svg, 'output');\n    var clustersGroup = createOrSelectGroup(outputGroup, 'clusters');\n    var edgePathsGroup = createOrSelectGroup(outputGroup, 'edgePaths');\n    var edgeLabels = createEdgeLabels(createOrSelectGroup(outputGroup, 'edgeLabels'), g);\n    var nodes = createNodes(createOrSelectGroup(outputGroup, 'nodes'), g, shapes);\n    layout(g);\n    positionNodes(nodes, g);\n    positionEdgeLabels(edgeLabels, g);\n    createEdgePaths(edgePathsGroup, g, arrows);\n    var clusters = createClusters(clustersGroup, g);\n    positionClusters(clusters, g);\n    postProcessGraph(g);\n  };\n\n  fn.createNodes = function (value) {\n    if (!arguments.length) return createNodes;\n    setCreateNodes(value);\n    return fn;\n  };\n\n  fn.createClusters = function (value) {\n    if (!arguments.length) return createClusters;\n    setCreateClusters(value);\n    return fn;\n  };\n\n  fn.createEdgeLabels = function (value) {\n    if (!arguments.length) return createEdgeLabels;\n    setCreateEdgeLabels(value);\n    return fn;\n  };\n\n  fn.createEdgePaths = function (value) {\n    if (!arguments.length) return createEdgePaths;\n    setCreateEdgePaths(value);\n    return fn;\n  };\n\n  fn.shapes = function (value) {\n    if (!arguments.length) return shapes;\n    setShapes(value);\n    return fn;\n  };\n\n  fn.arrows = function (value) {\n    if (!arguments.length) return arrows;\n    setArrows(value);\n    return fn;\n  };\n\n  return fn;\n}\n\nvar NODE_DEFAULT_ATTRS = {\n  paddingLeft: 10,\n  paddingRight: 10,\n  paddingTop: 10,\n  paddingBottom: 10,\n  rx: 0,\n  ry: 0,\n  shape: 'rect'\n};\nvar EDGE_DEFAULT_ATTRS = {\n  arrowhead: 'normal',\n  curve: d3.curveLinear\n};\n\nfunction preProcessGraph(g) {\n  g.nodes().forEach(function (v) {\n    var node = g.node(v);\n\n    if (!_.has(node, 'label') && !g.children(v).length) {\n      node.label = v;\n    }\n\n    if (_.has(node, 'paddingX')) {\n      _.defaults(node, {\n        paddingLeft: node.paddingX,\n        paddingRight: node.paddingX\n      });\n    }\n\n    if (_.has(node, 'paddingY')) {\n      _.defaults(node, {\n        paddingTop: node.paddingY,\n        paddingBottom: node.paddingY\n      });\n    }\n\n    if (_.has(node, 'padding')) {\n      _.defaults(node, {\n        paddingLeft: node.padding,\n        paddingRight: node.padding,\n        paddingTop: node.padding,\n        paddingBottom: node.padding\n      });\n    }\n\n    _.defaults(node, NODE_DEFAULT_ATTRS);\n\n    _.each(['paddingLeft', 'paddingRight', 'paddingTop', 'paddingBottom'], function (k) {\n      node[k] = Number(node[k]);\n    }); // Save dimensions for restore during post-processing\n\n\n    if (_.has(node, 'width')) {\n      node._prevWidth = node.width;\n    }\n\n    if (_.has(node, 'height')) {\n      node._prevHeight = node.height;\n    }\n  });\n  g.edges().forEach(function (e) {\n    var edge = g.edge(e);\n\n    if (!_.has(edge, 'label')) {\n      edge.label = '';\n    }\n\n    _.defaults(edge, EDGE_DEFAULT_ATTRS);\n  });\n}\n\nfunction postProcessGraph(g) {\n  _.each(g.nodes(), function (v) {\n    var node = g.node(v); // Restore original dimensions\n\n    if (_.has(node, '_prevWidth')) {\n      node.width = node._prevWidth;\n    } else {\n      delete node.width;\n    }\n\n    if (_.has(node, '_prevHeight')) {\n      node.height = node._prevHeight;\n    } else {\n      delete node.height;\n    }\n\n    delete node._prevWidth;\n    delete node._prevHeight;\n  });\n}\n\nfunction createOrSelectGroup(root, name) {\n  var selection = root.select('g.' + name);\n\n  if (selection.empty()) {\n    selection = root.append('g').attr('class', name);\n  }\n\n  return selection;\n}","map":{"version":3,"names":["d3","_","layout","arrows","setArrows","createClusters","setCreateClusters","createEdgeLabels","setCreateEdgeLabels","createEdgePaths","setCreateEdgePaths","createNodes","setCreateNodes","positionClusters","positionEdgeLabels","positionNodes","shapes","setShapes","render","fn","svg","g","preProcessGraph","outputGroup","createOrSelectGroup","clustersGroup","edgePathsGroup","edgeLabels","nodes","clusters","postProcessGraph","value","arguments","length","NODE_DEFAULT_ATTRS","paddingLeft","paddingRight","paddingTop","paddingBottom","rx","ry","shape","EDGE_DEFAULT_ATTRS","arrowhead","curve","curveLinear","forEach","v","node","has","children","label","defaults","paddingX","paddingY","padding","each","k","Number","_prevWidth","width","_prevHeight","height","edges","e","edge","root","name","selection","select","empty","append","attr"],"sources":["/Users/lord/Documents/Programmer/vue/VueProjects/blog-vue/blog-web/node_modules/dagre-d3-es/src/dagre-js/render.js"],"sourcesContent":["import * as d3 from 'd3';\nimport * as _ from 'lodash-es';\nimport { layout } from '../dagre/index.js';\nimport { arrows, setArrows } from './arrows.js';\nimport { createClusters, setCreateClusters } from './create-clusters.js';\nimport { createEdgeLabels, setCreateEdgeLabels } from './create-edge-labels.js';\nimport { createEdgePaths, setCreateEdgePaths } from './create-edge-paths.js';\nimport { createNodes, setCreateNodes } from './create-nodes.js';\nimport { positionClusters } from './position-clusters.js';\nimport { positionEdgeLabels } from './position-edge-labels.js';\nimport { positionNodes } from './position-nodes.js';\nimport { shapes, setShapes } from './shapes.js';\n\nexport { render };\n\n// This design is based on http://bost.ocks.org/mike/chart/.\nfunction render() {\n  var fn = function (svg, g) {\n    preProcessGraph(g);\n\n    var outputGroup = createOrSelectGroup(svg, 'output');\n    var clustersGroup = createOrSelectGroup(outputGroup, 'clusters');\n    var edgePathsGroup = createOrSelectGroup(outputGroup, 'edgePaths');\n    var edgeLabels = createEdgeLabels(createOrSelectGroup(outputGroup, 'edgeLabels'), g);\n    var nodes = createNodes(createOrSelectGroup(outputGroup, 'nodes'), g, shapes);\n\n    layout(g);\n\n    positionNodes(nodes, g);\n    positionEdgeLabels(edgeLabels, g);\n    createEdgePaths(edgePathsGroup, g, arrows);\n\n    var clusters = createClusters(clustersGroup, g);\n    positionClusters(clusters, g);\n\n    postProcessGraph(g);\n  };\n\n  fn.createNodes = function (value) {\n    if (!arguments.length) return createNodes;\n    setCreateNodes(value);\n    return fn;\n  };\n\n  fn.createClusters = function (value) {\n    if (!arguments.length) return createClusters;\n    setCreateClusters(value);\n    return fn;\n  };\n\n  fn.createEdgeLabels = function (value) {\n    if (!arguments.length) return createEdgeLabels;\n    setCreateEdgeLabels(value);\n    return fn;\n  };\n\n  fn.createEdgePaths = function (value) {\n    if (!arguments.length) return createEdgePaths;\n    setCreateEdgePaths(value);\n    return fn;\n  };\n\n  fn.shapes = function (value) {\n    if (!arguments.length) return shapes;\n    setShapes(value);\n    return fn;\n  };\n\n  fn.arrows = function (value) {\n    if (!arguments.length) return arrows;\n    setArrows(value);\n    return fn;\n  };\n\n  return fn;\n}\n\nvar NODE_DEFAULT_ATTRS = {\n  paddingLeft: 10,\n  paddingRight: 10,\n  paddingTop: 10,\n  paddingBottom: 10,\n  rx: 0,\n  ry: 0,\n  shape: 'rect',\n};\n\nvar EDGE_DEFAULT_ATTRS = {\n  arrowhead: 'normal',\n  curve: d3.curveLinear,\n};\n\nfunction preProcessGraph(g) {\n  g.nodes().forEach(function (v) {\n    var node = g.node(v);\n    if (!_.has(node, 'label') && !g.children(v).length) {\n      node.label = v;\n    }\n\n    if (_.has(node, 'paddingX')) {\n      _.defaults(node, {\n        paddingLeft: node.paddingX,\n        paddingRight: node.paddingX,\n      });\n    }\n\n    if (_.has(node, 'paddingY')) {\n      _.defaults(node, {\n        paddingTop: node.paddingY,\n        paddingBottom: node.paddingY,\n      });\n    }\n\n    if (_.has(node, 'padding')) {\n      _.defaults(node, {\n        paddingLeft: node.padding,\n        paddingRight: node.padding,\n        paddingTop: node.padding,\n        paddingBottom: node.padding,\n      });\n    }\n\n    _.defaults(node, NODE_DEFAULT_ATTRS);\n\n    _.each(['paddingLeft', 'paddingRight', 'paddingTop', 'paddingBottom'], function (k) {\n      node[k] = Number(node[k]);\n    });\n\n    // Save dimensions for restore during post-processing\n    if (_.has(node, 'width')) {\n      node._prevWidth = node.width;\n    }\n    if (_.has(node, 'height')) {\n      node._prevHeight = node.height;\n    }\n  });\n\n  g.edges().forEach(function (e) {\n    var edge = g.edge(e);\n    if (!_.has(edge, 'label')) {\n      edge.label = '';\n    }\n    _.defaults(edge, EDGE_DEFAULT_ATTRS);\n  });\n}\n\nfunction postProcessGraph(g) {\n  _.each(g.nodes(), function (v) {\n    var node = g.node(v);\n\n    // Restore original dimensions\n    if (_.has(node, '_prevWidth')) {\n      node.width = node._prevWidth;\n    } else {\n      delete node.width;\n    }\n\n    if (_.has(node, '_prevHeight')) {\n      node.height = node._prevHeight;\n    } else {\n      delete node.height;\n    }\n\n    delete node._prevWidth;\n    delete node._prevHeight;\n  });\n}\n\nfunction createOrSelectGroup(root, name) {\n  var selection = root.select('g.' + name);\n  if (selection.empty()) {\n    selection = root.append('g').attr('class', name);\n  }\n  return selection;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}