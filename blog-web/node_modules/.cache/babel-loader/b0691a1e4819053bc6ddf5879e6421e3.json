{"ast":null,"code":"import { computed, unref } from 'vue';\nimport '../../../../utils/index.mjs';\nimport { SortOrder, oppositeOrderMap } from '../constants.mjs';\nimport { placeholderSign } from '../private.mjs';\nimport { calcColumnStyle } from './utils.mjs';\nimport { isObject } from '@vue/shared';\n\nfunction useColumns(props, columns, fixed) {\n  const visibleColumns = computed(() => {\n    return unref(columns).filter(column => !column.hidden);\n  });\n  const fixedColumnsOnLeft = computed(() => unref(visibleColumns).filter(column => column.fixed === \"left\" || column.fixed === true));\n  const fixedColumnsOnRight = computed(() => unref(visibleColumns).filter(column => column.fixed === \"right\"));\n  const normalColumns = computed(() => unref(visibleColumns).filter(column => !column.fixed));\n  const mainColumns = computed(() => {\n    const ret = [];\n    unref(fixedColumnsOnLeft).forEach(column => {\n      ret.push({ ...column,\n        placeholderSign\n      });\n    });\n    unref(normalColumns).forEach(column => {\n      ret.push(column);\n    });\n    unref(fixedColumnsOnRight).forEach(column => {\n      ret.push({ ...column,\n        placeholderSign\n      });\n    });\n    return ret;\n  });\n  const hasFixedColumns = computed(() => {\n    return unref(fixedColumnsOnLeft).length || unref(fixedColumnsOnRight).length;\n  });\n  const columnsStyles = computed(() => {\n    const _columns = unref(columns);\n\n    return _columns.reduce((style, column) => {\n      style[column.key] = calcColumnStyle(column, unref(fixed), props.fixed);\n      return style;\n    }, {});\n  });\n  const columnsTotalWidth = computed(() => {\n    return unref(visibleColumns).reduce((width, column) => width + column.width, 0);\n  });\n\n  const getColumn = key => {\n    return unref(columns).find(column => column.key === key);\n  };\n\n  const getColumnStyle = key => {\n    return unref(columnsStyles)[key];\n  };\n\n  const updateColumnWidth = (column, width) => {\n    column.width = width;\n  };\n\n  function onColumnSorted(e) {\n    var _a;\n\n    const {\n      key\n    } = e.currentTarget.dataset;\n    if (!key) return;\n    const {\n      sortState,\n      sortBy\n    } = props;\n    let order = SortOrder.ASC;\n\n    if (isObject(sortState)) {\n      order = oppositeOrderMap[sortState[key]];\n    } else {\n      order = oppositeOrderMap[sortBy.order];\n    }\n\n    (_a = props.onColumnSort) == null ? void 0 : _a.call(props, {\n      column: getColumn(key),\n      key,\n      order\n    });\n  }\n\n  return {\n    columns,\n    columnsStyles,\n    columnsTotalWidth,\n    fixedColumnsOnLeft,\n    fixedColumnsOnRight,\n    hasFixedColumns,\n    mainColumns,\n    normalColumns,\n    visibleColumns,\n    getColumn,\n    getColumnStyle,\n    updateColumnWidth,\n    onColumnSorted\n  };\n}\n\nexport { useColumns };","map":null,"metadata":{},"sourceType":"module"}