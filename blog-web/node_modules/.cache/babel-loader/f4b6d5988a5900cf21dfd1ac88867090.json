{"ast":null,"code":"import * as d3 from 'd3';\nimport * as _ from 'lodash-es';\nimport { intersectNode } from './intersect/intersect-node.js';\nimport * as util from './util.js';\nexport { createEdgePaths, setCreateEdgePaths };\n\nvar createEdgePaths = function (selection, g, arrows) {\n  var previousPaths = selection.selectAll('g.edgePath').data(g.edges(), function (e) {\n    return util.edgeToId(e);\n  }).classed('update', true);\n  var newPaths = enter(previousPaths, g);\n  exit(previousPaths, g);\n  var svgPaths = previousPaths.merge !== undefined ? previousPaths.merge(newPaths) : previousPaths;\n  util.applyTransition(svgPaths, g).style('opacity', 1); // Save DOM element in the path group, and set ID and class\n\n  svgPaths.each(function (e) {\n    var domEdge = d3.select(this);\n    var edge = g.edge(e);\n    edge.elem = this;\n\n    if (edge.id) {\n      domEdge.attr('id', edge.id);\n    }\n\n    util.applyClass(domEdge, edge['class'], (domEdge.classed('update') ? 'update ' : '') + 'edgePath');\n  });\n  svgPaths.selectAll('path.path').each(function (e) {\n    var edge = g.edge(e);\n    edge.arrowheadId = _.uniqueId('arrowhead');\n    var domEdge = d3.select(this).attr('marker-end', function () {\n      return 'url(' + makeFragmentRef(location.href, edge.arrowheadId) + ')';\n    }).style('fill', 'none');\n    util.applyTransition(domEdge, g).attr('d', function (e) {\n      return calcPoints(g, e);\n    });\n    util.applyStyle(domEdge, edge.style);\n  });\n  svgPaths.selectAll('defs *').remove();\n  svgPaths.selectAll('defs').each(function (e) {\n    var edge = g.edge(e);\n    var arrowhead = arrows[edge.arrowhead];\n    arrowhead(d3.select(this), edge.arrowheadId, edge, 'arrowhead');\n  });\n  return svgPaths;\n};\n\nfunction setCreateEdgePaths(value) {\n  createEdgePaths = value;\n}\n\nfunction makeFragmentRef(url, fragmentId) {\n  var baseUrl = url.split('#')[0];\n  return baseUrl + '#' + fragmentId;\n}\n\nfunction calcPoints(g, e) {\n  var edge = g.edge(e);\n  var tail = g.node(e.v);\n  var head = g.node(e.w);\n  var points = edge.points.slice(1, edge.points.length - 1);\n  points.unshift(intersectNode(tail, points[0]));\n  points.push(intersectNode(head, points[points.length - 1]));\n  return createLine(edge, points);\n}\n\nfunction createLine(edge, points) {\n  // @ts-expect-error\n  var line = (d3.line || d3.svg.line)().x(function (d) {\n    return d.x;\n  }).y(function (d) {\n    return d.y;\n  });\n  (line.curve || line.interpolate)(edge.curve);\n  return line(points);\n}\n\nfunction getCoords(elem) {\n  var bbox = elem.getBBox();\n  var matrix = elem.ownerSVGElement.getScreenCTM().inverse().multiply(elem.getScreenCTM()).translate(bbox.width / 2, bbox.height / 2);\n  return {\n    x: matrix.e,\n    y: matrix.f\n  };\n}\n\nfunction enter(svgPaths, g) {\n  var svgPathsEnter = svgPaths.enter().append('g').attr('class', 'edgePath').style('opacity', 0);\n  svgPathsEnter.append('path').attr('class', 'path').attr('d', function (e) {\n    var edge = g.edge(e);\n    var sourceElem = g.node(e.v).elem;\n\n    var points = _.range(edge.points.length).map(function () {\n      return getCoords(sourceElem);\n    });\n\n    return createLine(edge, points);\n  });\n  svgPathsEnter.append('defs');\n  return svgPathsEnter;\n}\n\nfunction exit(svgPaths, g) {\n  var svgPathExit = svgPaths.exit();\n  util.applyTransition(svgPathExit, g).style('opacity', 0).remove();\n}","map":{"version":3,"names":["d3","_","intersectNode","util","createEdgePaths","setCreateEdgePaths","selection","g","arrows","previousPaths","selectAll","data","edges","e","edgeToId","classed","newPaths","enter","exit","svgPaths","merge","undefined","applyTransition","style","each","domEdge","select","edge","elem","id","attr","applyClass","arrowheadId","uniqueId","makeFragmentRef","location","href","calcPoints","applyStyle","remove","arrowhead","value","url","fragmentId","baseUrl","split","tail","node","v","head","w","points","slice","length","unshift","push","createLine","line","svg","x","d","y","curve","interpolate","getCoords","bbox","getBBox","matrix","ownerSVGElement","getScreenCTM","inverse","multiply","translate","width","height","f","svgPathsEnter","append","sourceElem","range","map","svgPathExit"],"sources":["/Users/lord/Documents/Programmer/vue/VueProjects/cloudycraft-vue/blog-web/node_modules/dagre-d3-es/src/dagre-js/create-edge-paths.js"],"sourcesContent":["import * as d3 from 'd3';\nimport * as _ from 'lodash-es';\nimport { intersectNode } from './intersect/intersect-node.js';\nimport * as util from './util.js';\n\nexport { createEdgePaths, setCreateEdgePaths };\n\nvar createEdgePaths = function (selection, g, arrows) {\n  var previousPaths = selection\n    .selectAll('g.edgePath')\n    .data(g.edges(), function (e) {\n      return util.edgeToId(e);\n    })\n    .classed('update', true);\n\n  var newPaths = enter(previousPaths, g);\n  exit(previousPaths, g);\n\n  var svgPaths = previousPaths.merge !== undefined ? previousPaths.merge(newPaths) : previousPaths;\n  util.applyTransition(svgPaths, g).style('opacity', 1);\n\n  // Save DOM element in the path group, and set ID and class\n  svgPaths.each(function (e) {\n    var domEdge = d3.select(this);\n    var edge = g.edge(e);\n    edge.elem = this;\n\n    if (edge.id) {\n      domEdge.attr('id', edge.id);\n    }\n\n    util.applyClass(\n      domEdge,\n      edge['class'],\n      (domEdge.classed('update') ? 'update ' : '') + 'edgePath'\n    );\n  });\n\n  svgPaths.selectAll('path.path').each(function (e) {\n    var edge = g.edge(e);\n    edge.arrowheadId = _.uniqueId('arrowhead');\n\n    var domEdge = d3\n      .select(this)\n      .attr('marker-end', function () {\n        return 'url(' + makeFragmentRef(location.href, edge.arrowheadId) + ')';\n      })\n      .style('fill', 'none');\n\n    util.applyTransition(domEdge, g).attr('d', function (e) {\n      return calcPoints(g, e);\n    });\n\n    util.applyStyle(domEdge, edge.style);\n  });\n\n  svgPaths.selectAll('defs *').remove();\n  svgPaths.selectAll('defs').each(function (e) {\n    var edge = g.edge(e);\n    var arrowhead = arrows[edge.arrowhead];\n    arrowhead(d3.select(this), edge.arrowheadId, edge, 'arrowhead');\n  });\n\n  return svgPaths;\n};\n\nfunction setCreateEdgePaths(value) {\n  createEdgePaths = value;\n}\n\nfunction makeFragmentRef(url, fragmentId) {\n  var baseUrl = url.split('#')[0];\n  return baseUrl + '#' + fragmentId;\n}\n\nfunction calcPoints(g, e) {\n  var edge = g.edge(e);\n  var tail = g.node(e.v);\n  var head = g.node(e.w);\n  var points = edge.points.slice(1, edge.points.length - 1);\n  points.unshift(intersectNode(tail, points[0]));\n  points.push(intersectNode(head, points[points.length - 1]));\n\n  return createLine(edge, points);\n}\n\nfunction createLine(edge, points) {\n  // @ts-expect-error\n  var line = (d3.line || d3.svg.line)()\n    .x(function (d) {\n      return d.x;\n    })\n    .y(function (d) {\n      return d.y;\n    });\n\n  (line.curve || line.interpolate)(edge.curve);\n\n  return line(points);\n}\n\nfunction getCoords(elem) {\n  var bbox = elem.getBBox();\n  var matrix = elem.ownerSVGElement\n    .getScreenCTM()\n    .inverse()\n    .multiply(elem.getScreenCTM())\n    .translate(bbox.width / 2, bbox.height / 2);\n  return { x: matrix.e, y: matrix.f };\n}\n\nfunction enter(svgPaths, g) {\n  var svgPathsEnter = svgPaths.enter().append('g').attr('class', 'edgePath').style('opacity', 0);\n  svgPathsEnter\n    .append('path')\n    .attr('class', 'path')\n    .attr('d', function (e) {\n      var edge = g.edge(e);\n      var sourceElem = g.node(e.v).elem;\n      var points = _.range(edge.points.length).map(function () {\n        return getCoords(sourceElem);\n      });\n      return createLine(edge, points);\n    });\n  svgPathsEnter.append('defs');\n  return svgPathsEnter;\n}\n\nfunction exit(svgPaths, g) {\n  var svgPathExit = svgPaths.exit();\n  util.applyTransition(svgPathExit, g).style('opacity', 0).remove();\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}